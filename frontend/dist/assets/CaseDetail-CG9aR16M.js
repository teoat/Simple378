import{j as f,c as Nt}from"./query-vendor-CvBDT0OD.js";import{f as x,a as p,j as ms,L as gs}from"./react-vendor-BuVNz1jA.js";import{l as Ve,k as tn,A as nn,m as St,j as vt}from"./index-BlWFTSEC.js";import{y as ps,p as In,w as xs,H as ys,A as bs,r as ws,q as Es,N as Ns,I as Ss,J as _n,z as Je}from"./ui-vendor-DqTYRHc5.js";import{u as vs,R as ks,B as Cs,d as Ms,X as As,Y as js,T as $s,L as Is,a as on}from"./viz-vendor-Yg1nQkEx.js";import{i as _e,z as Tn,s as Bt,p as Dn,d as _s}from"./zoom-XumfBP2-.js";import{S as Ts,R as Ds}from"./StatusBadge-C8jebGG_.js";import{P as Hs}from"./PageErrorBoundary-BlW1gdj2.js";function ie(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,o;n<e.length;n++)(o=ie(e[n]))!==""&&(t+=(t&&" ")+o);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}const Rs={},sn=e=>{let t;const n=new Set,o=(c,d)=>{const m=typeof c=="function"?c(t):c;if(!Object.is(m,t)){const h=t;t=d??(typeof m!="object"||m===null)?m:Object.assign({},t,m),n.forEach(w=>w(t,h))}},s=()=>t,l={setState:o,getState:s,getInitialState:()=>u,subscribe:c=>(n.add(c),()=>n.delete(c)),destroy:()=>{(Rs?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},u=t=e(o,s,l);return l},Ps=e=>e?sn(e):sn,{useDebugValue:zs}=x,{useSyncExternalStoreWithSelector:Bs}=vs,Os=e=>e;function Hn(e,t=Os,n){const o=Bs(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return zs(o),o}const rn=(e,t)=>{const n=Ps(e),o=(s,r=t)=>Hn(n,s,r);return Object.assign(o,n),o},Vs=(e,t)=>e?rn(e,t):rn;function re(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[o,s]of e)if(!Object.is(s,t.get(o)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const o of n)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}const gt=p.createContext(null),Ls=gt.Provider,be={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},Rn=be.error001();function J(e,t){const n=p.useContext(gt);if(n===null)throw new Error(Rn);return Hn(n,e,t)}const se=()=>{const e=p.useContext(gt);if(e===null)throw new Error(Rn);return p.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},Fs=e=>e.userSelectionActive?"none":"all";function Ot({position:e,children:t,className:n,style:o,...s}){const r=J(Fs),a=`${e}`.split("-");return x.createElement("div",{className:ie(["react-flow__panel",n,...a]),style:{...o,pointerEvents:r},...s},t)}function Zs({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:x.createElement(Ot,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},x.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const Ys=({x:e,y:t,label:n,labelStyle:o={},labelShowBg:s=!0,labelBgStyle:r={},labelBgPadding:a=[2,4],labelBgBorderRadius:i=2,children:l,className:u,...c})=>{const d=p.useRef(null),[m,h]=p.useState({x:0,y:0,width:0,height:0}),w=ie(["react-flow__edge-textwrapper",u]);return p.useEffect(()=>{if(d.current){const g=d.current.getBBox();h({x:g.x,y:g.y,width:g.width,height:g.height})}},[n]),typeof n>"u"||!n?null:x.createElement("g",{transform:`translate(${e-m.width/2} ${t-m.height/2})`,className:w,visibility:m.width?"visible":"hidden",...c},s&&x.createElement("rect",{width:m.width+2*a[0],x:-a[0],y:-a[1],height:m.height+2*a[1],className:"react-flow__edge-textbg",style:r,rx:i,ry:i}),x.createElement("text",{className:"react-flow__edge-text",y:m.height/2,dy:"0.3em",ref:d,style:o},n),l)};var Ws=p.memo(Ys);const Vt=e=>({width:e.offsetWidth,height:e.offsetHeight}),Ge=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Lt=(e={x:0,y:0},t)=>({x:Ge(e.x,t[0][0],t[1][0]),y:Ge(e.y,t[0][1],t[1][1])}),an=(e,t,n)=>e<t?Ge(Math.abs(e-t),1,50)/50:e>n?-Ge(Math.abs(e-n),1,50)/50:0,Pn=(e,t)=>{const n=an(e.x,35,t.width-35)*20,o=an(e.y,35,t.height-35)*20;return[n,o]},zn=e=>e.getRootNode?.()||window?.document,Bn=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),ot=({x:e,y:t,width:n,height:o})=>({x:e,y:t,x2:e+n,y2:t+o}),On=({x:e,y:t,x2:n,y2:o})=>({x:e,y:t,width:n-e,height:o-t}),cn=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),Us=(e,t)=>On(Bn(ot(e),ot(t))),It=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)},Gs=e=>he(e.width)&&he(e.height)&&he(e.x)&&he(e.y),he=e=>!isNaN(e)&&isFinite(e),Q=Symbol.for("internals"),Vn=["Enter"," ","Escape"],Xs=(e,t)=>{},Ks=e=>"nativeEvent"in e;function _t(e){const n=(Ks(e)?e.nativeEvent:e).composedPath?.()?.[0]||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n?.nodeName)||n?.hasAttribute("contenteditable")||!!n?.closest(".nokey")}const Ln=e=>"clientX"in e,Se=(e,t)=>{const n=Ln(e),o=n?e.clientX:e.touches?.[0].clientX,s=n?e.clientY:e.touches?.[0].clientY;return{x:o-(t?.left??0),y:s-(t?.top??0)}},ut=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0,at=({id:e,path:t,labelX:n,labelY:o,label:s,labelStyle:r,labelShowBg:a,labelBgStyle:i,labelBgPadding:l,labelBgBorderRadius:u,style:c,markerEnd:d,markerStart:m,interactionWidth:h=20})=>x.createElement(x.Fragment,null,x.createElement("path",{id:e,style:c,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:d,markerStart:m}),h&&x.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:h,className:"react-flow__edge-interaction"}),s&&he(n)&&he(o)?x.createElement(Ws,{x:n,y:o,label:s,labelStyle:r,labelShowBg:a,labelBgStyle:i,labelBgPadding:l,labelBgBorderRadius:u}):null);at.displayName="BaseEdge";function Qe(e,t,n){return n===void 0?n:o=>{const s=t().edges.find(r=>r.id===e);s&&n(o,{...s})}}function Fn({sourceX:e,sourceY:t,targetX:n,targetY:o}){const s=Math.abs(n-e)/2,r=n<e?n+s:n-s,a=Math.abs(o-t)/2,i=o<t?o+a:o-a;return[r,i,s,a]}function Zn({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:s,sourceControlY:r,targetControlX:a,targetControlY:i}){const l=e*.125+s*.375+a*.375+n*.125,u=t*.125+r*.375+i*.375+o*.125,c=Math.abs(l-e),d=Math.abs(u-t);return[l,u,c,d]}var De;(function(e){e.Strict="strict",e.Loose="loose"})(De||(De={}));var Ie;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Ie||(Ie={}));var st;(function(e){e.Partial="partial",e.Full="full"})(st||(st={}));var Ne;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Ne||(Ne={}));var ft;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(ft||(ft={}));var V;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(V||(V={}));function ln({pos:e,x1:t,y1:n,x2:o,y2:s}){return e===V.Left||e===V.Right?[.5*(t+o),n]:[t,.5*(n+s)]}function Yn({sourceX:e,sourceY:t,sourcePosition:n=V.Bottom,targetX:o,targetY:s,targetPosition:r=V.Top}){const[a,i]=ln({pos:n,x1:e,y1:t,x2:o,y2:s}),[l,u]=ln({pos:r,x1:o,y1:s,x2:e,y2:t}),[c,d,m,h]=Zn({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:a,sourceControlY:i,targetControlX:l,targetControlY:u});return[`M${e},${t} C${a},${i} ${l},${u} ${o},${s}`,c,d,m,h]}const Ft=p.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,sourcePosition:s=V.Bottom,targetPosition:r=V.Top,label:a,labelStyle:i,labelShowBg:l,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:d,style:m,markerEnd:h,markerStart:w,interactionWidth:g})=>{const[y,b,E]=Yn({sourceX:e,sourceY:t,sourcePosition:s,targetX:n,targetY:o,targetPosition:r});return x.createElement(at,{path:y,labelX:b,labelY:E,label:a,labelStyle:i,labelShowBg:l,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:d,style:m,markerEnd:h,markerStart:w,interactionWidth:g})});Ft.displayName="SimpleBezierEdge";const dn={[V.Left]:{x:-1,y:0},[V.Right]:{x:1,y:0},[V.Top]:{x:0,y:-1},[V.Bottom]:{x:0,y:1}},qs=({source:e,sourcePosition:t=V.Bottom,target:n})=>t===V.Left||t===V.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},un=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Js({source:e,sourcePosition:t=V.Bottom,target:n,targetPosition:o=V.Top,center:s,offset:r}){const a=dn[t],i=dn[o],l={x:e.x+a.x*r,y:e.y+a.y*r},u={x:n.x+i.x*r,y:n.y+i.y*r},c=qs({source:l,sourcePosition:t,target:u}),d=c.x!==0?"x":"y",m=c[d];let h=[],w,g;const y={x:0,y:0},b={x:0,y:0},[E,v,C,$]=Fn({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(a[d]*i[d]===-1){w=s.x??E,g=s.y??v;const B=[{x:w,y:l.y},{x:w,y:u.y}],H=[{x:l.x,y:g},{x:u.x,y:g}];a[d]===m?h=d==="x"?B:H:h=d==="x"?H:B}else{const B=[{x:l.x,y:u.y}],H=[{x:u.x,y:l.y}];if(d==="x"?h=a.x===m?H:B:h=a.y===m?B:H,t===o){const M=Math.abs(e[d]-n[d]);if(M<=r){const N=Math.min(r-1,r-M);a[d]===m?y[d]=(l[d]>e[d]?-1:1)*N:b[d]=(u[d]>n[d]?-1:1)*N}}if(t!==o){const M=d==="x"?"y":"x",N=a[d]===i[M],j=l[M]>u[M],P=l[M]<u[M];(a[d]===1&&(!N&&j||N&&P)||a[d]!==1&&(!N&&P||N&&j))&&(h=d==="x"?B:H)}const k={x:l.x+y.x,y:l.y+y.y},I={x:u.x+b.x,y:u.y+b.y},_=Math.max(Math.abs(k.x-h[0].x),Math.abs(I.x-h[0].x)),T=Math.max(Math.abs(k.y-h[0].y),Math.abs(I.y-h[0].y));_>=T?(w=(k.x+I.x)/2,g=h[0].y):(w=h[0].x,g=(k.y+I.y)/2)}return[[e,{x:l.x+y.x,y:l.y+y.y},...h,{x:u.x+b.x,y:u.y+b.y},n],w,g,C,$]}function Qs(e,t,n,o){const s=Math.min(un(e,t)/2,un(t,n)/2,o),{x:r,y:a}=t;if(e.x===r&&r===n.x||e.y===a&&a===n.y)return`L${r} ${a}`;if(e.y===a){const u=e.x<n.x?-1:1,c=e.y<n.y?1:-1;return`L ${r+s*u},${a}Q ${r},${a} ${r},${a+s*c}`}const i=e.x<n.x?1:-1,l=e.y<n.y?-1:1;return`L ${r},${a+s*l}Q ${r},${a} ${r+s*i},${a}`}function Tt({sourceX:e,sourceY:t,sourcePosition:n=V.Bottom,targetX:o,targetY:s,targetPosition:r=V.Top,borderRadius:a=5,centerX:i,centerY:l,offset:u=20}){const[c,d,m,h,w]=Js({source:{x:e,y:t},sourcePosition:n,target:{x:o,y:s},targetPosition:r,center:{x:i,y:l},offset:u});return[c.reduce((y,b,E)=>{let v="";return E>0&&E<c.length-1?v=Qs(c[E-1],b,c[E+1],a):v=`${E===0?"M":"L"}${b.x} ${b.y}`,y+=v,y},""),d,m,h,w]}const pt=p.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,label:s,labelStyle:r,labelShowBg:a,labelBgStyle:i,labelBgPadding:l,labelBgBorderRadius:u,style:c,sourcePosition:d=V.Bottom,targetPosition:m=V.Top,markerEnd:h,markerStart:w,pathOptions:g,interactionWidth:y})=>{const[b,E,v]=Tt({sourceX:e,sourceY:t,sourcePosition:d,targetX:n,targetY:o,targetPosition:m,borderRadius:g?.borderRadius,offset:g?.offset});return x.createElement(at,{path:b,labelX:E,labelY:v,label:s,labelStyle:r,labelShowBg:a,labelBgStyle:i,labelBgPadding:l,labelBgBorderRadius:u,style:c,markerEnd:h,markerStart:w,interactionWidth:y})});pt.displayName="SmoothStepEdge";const Zt=p.memo(e=>x.createElement(pt,{...e,pathOptions:p.useMemo(()=>({borderRadius:0,offset:e.pathOptions?.offset}),[e.pathOptions?.offset])}));Zt.displayName="StepEdge";function er({sourceX:e,sourceY:t,targetX:n,targetY:o}){const[s,r,a,i]=Fn({sourceX:e,sourceY:t,targetX:n,targetY:o});return[`M ${e},${t}L ${n},${o}`,s,r,a,i]}const Yt=p.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,label:s,labelStyle:r,labelShowBg:a,labelBgStyle:i,labelBgPadding:l,labelBgBorderRadius:u,style:c,markerEnd:d,markerStart:m,interactionWidth:h})=>{const[w,g,y]=er({sourceX:e,sourceY:t,targetX:n,targetY:o});return x.createElement(at,{path:w,labelX:g,labelY:y,label:s,labelStyle:r,labelShowBg:a,labelBgStyle:i,labelBgPadding:l,labelBgBorderRadius:u,style:c,markerEnd:d,markerStart:m,interactionWidth:h})});Yt.displayName="StraightEdge";function it(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function fn({pos:e,x1:t,y1:n,x2:o,y2:s,c:r}){switch(e){case V.Left:return[t-it(t-o,r),n];case V.Right:return[t+it(o-t,r),n];case V.Top:return[t,n-it(n-s,r)];case V.Bottom:return[t,n+it(s-n,r)]}}function Wn({sourceX:e,sourceY:t,sourcePosition:n=V.Bottom,targetX:o,targetY:s,targetPosition:r=V.Top,curvature:a=.25}){const[i,l]=fn({pos:n,x1:e,y1:t,x2:o,y2:s,c:a}),[u,c]=fn({pos:r,x1:o,y1:s,x2:e,y2:t,c:a}),[d,m,h,w]=Zn({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:i,sourceControlY:l,targetControlX:u,targetControlY:c});return[`M${e},${t} C${i},${l} ${u},${c} ${o},${s}`,d,m,h,w]}const ht=p.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,sourcePosition:s=V.Bottom,targetPosition:r=V.Top,label:a,labelStyle:i,labelShowBg:l,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:d,style:m,markerEnd:h,markerStart:w,pathOptions:g,interactionWidth:y})=>{const[b,E,v]=Wn({sourceX:e,sourceY:t,sourcePosition:s,targetX:n,targetY:o,targetPosition:r,curvature:g?.curvature});return x.createElement(at,{path:b,labelX:E,labelY:v,label:a,labelStyle:i,labelShowBg:l,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:d,style:m,markerEnd:h,markerStart:w,interactionWidth:y})});ht.displayName="BezierEdge";const Wt=p.createContext(null),tr=Wt.Provider;Wt.Consumer;const nr=()=>p.useContext(Wt),or=e=>"id"in e&&"source"in e&&"target"in e,sr=({source:e,sourceHandle:t,target:n,targetHandle:o})=>`reactflow__edge-${e}${t||""}-${n}${o||""}`,Dt=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`,rr=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),Un=(e,t)=>{if(!e.source||!e.target)return t;let n;return or(e)?n={...e}:n={...e,id:sr(e)},rr(n,t)?t:t.concat(n)},Ht=({x:e,y:t},[n,o,s],r,[a,i])=>{const l={x:(e-n)/s,y:(t-o)/s};return r?{x:a*Math.round(l.x/a),y:i*Math.round(l.y/i)}:l},Gn=({x:e,y:t},[n,o,s])=>({x:e*s+n,y:t*s+o}),Te=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(e.width??0)*t[0],o=(e.height??0)*t[1],s={x:e.position.x-n,y:e.position.y-o};return{...s,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-o}:s}},xt=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((o,s)=>{const{x:r,y:a}=Te(s,t).positionAbsolute;return Bn(o,ot({x:r,y:a,width:s.width||0,height:s.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return On(n)},Xn=(e,t,[n,o,s]=[0,0,1],r=!1,a=!1,i=[0,0])=>{const l={x:(t.x-n)/s,y:(t.y-o)/s,width:t.width/s,height:t.height/s},u=[];return e.forEach(c=>{const{width:d,height:m,selectable:h=!0,hidden:w=!1}=c;if(a&&!h||w)return!1;const{positionAbsolute:g}=Te(c,i),y={x:g.x,y:g.y,width:d||0,height:m||0},b=It(l,y),E=typeof d>"u"||typeof m>"u"||d===null||m===null,v=r&&b>0,C=(d||0)*(m||0);(E||v||b>=C||c.dragging)&&u.push(c)}),u},Kn=(e,t)=>{const n=e.map(o=>o.id);return t.filter(o=>n.includes(o.source)||n.includes(o.target))},qn=(e,t,n,o,s,r=.1)=>{const a=t/(e.width*(1+r)),i=n/(e.height*(1+r)),l=Math.min(a,i),u=Ge(l,o,s),c=e.x+e.width/2,d=e.y+e.height/2,m=t/2-c*u,h=n/2-d*u;return{x:m,y:h,zoom:u}},$e=(e,t=0)=>e.transition().duration(t);function hn(e,t,n,o){return(t[n]||[]).reduce((s,r)=>(`${e.id}-${r.id}-${n}`!==o&&s.push({id:r.id||null,type:n,nodeId:e.id,x:(e.positionAbsolute?.x??0)+r.x+r.width/2,y:(e.positionAbsolute?.y??0)+r.y+r.height/2}),s),[])}function ar(e,t,n,o,s,r){const{x:a,y:i}=Se(e),u=t.elementsFromPoint(a,i).find(w=>w.classList.contains("react-flow__handle"));if(u){const w=u.getAttribute("data-nodeid");if(w){const g=Ut(void 0,u),y=u.getAttribute("data-handleid"),b=r({nodeId:w,id:y,type:g});if(b){const E=s.find(v=>v.nodeId===w&&v.type===g&&v.id===y);return{handle:{id:y,type:g,nodeId:w,x:E?.x||n.x,y:E?.y||n.y},validHandleResult:b}}}}let c=[],d=1/0;if(s.forEach(w=>{const g=Math.sqrt((w.x-n.x)**2+(w.y-n.y)**2);if(g<=o){const y=r(w);g<=d&&(g<d?c=[{handle:w,validHandleResult:y}]:g===d&&c.push({handle:w,validHandleResult:y}),d=g)}}),!c.length)return{handle:null,validHandleResult:Jn()};if(c.length===1)return c[0];const m=c.some(({validHandleResult:w})=>w.isValid),h=c.some(({handle:w})=>w.type==="target");return c.find(({handle:w,validHandleResult:g})=>h?w.type==="target":m?g.isValid:!0)||c[0]}const ir={source:null,target:null,sourceHandle:null,targetHandle:null},Jn=()=>({handleDomNode:null,isValid:!1,connection:ir,endHandle:null});function Qn(e,t,n,o,s,r,a){const i=s==="target",l=a.querySelector(`.react-flow__handle[data-id="${e?.nodeId}-${e?.id}-${e?.type}"]`),u={...Jn(),handleDomNode:l};if(l){const c=Ut(void 0,l),d=l.getAttribute("data-nodeid"),m=l.getAttribute("data-handleid"),h=l.classList.contains("connectable"),w=l.classList.contains("connectableend"),g={source:i?d:n,sourceHandle:i?m:o,target:i?n:d,targetHandle:i?o:m};u.connection=g,h&&w&&(t===De.Strict?i&&c==="source"||!i&&c==="target":d!==n||m!==o)&&(u.endHandle={nodeId:d,handleId:m,type:c},u.isValid=r(g))}return u}function cr({nodes:e,nodeId:t,handleId:n,handleType:o}){return e.reduce((s,r)=>{if(r[Q]){const{handleBounds:a}=r[Q];let i=[],l=[];a&&(i=hn(r,a,"source",`${t}-${n}-${o}`),l=hn(r,a,"target",`${t}-${n}-${o}`)),s.push(...i,...l)}return s},[])}function Ut(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function kt(e){e?.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function lr(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function eo({event:e,handleId:t,nodeId:n,onConnect:o,isTarget:s,getState:r,setState:a,isValidConnection:i,edgeUpdaterType:l,onReconnectEnd:u}){const c=zn(e.target),{connectionMode:d,domNode:m,autoPanOnConnect:h,connectionRadius:w,onConnectStart:g,panBy:y,getNodes:b,cancelConnection:E}=r();let v=0,C;const{x:$,y:A}=Se(e),B=c?.elementFromPoint($,A),H=Ut(l,B),k=m?.getBoundingClientRect();if(!k||!H)return;let I,_=Se(e,k),T=!1,M=null,N=!1,j=null;const P=cr({nodes:b(),nodeId:n,handleId:t,handleType:H}),Z=()=>{if(!h)return;const[z,D]=Pn(_,k);y({x:z,y:D}),v=requestAnimationFrame(Z)};a({connectionPosition:_,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:H,connectionStartHandle:{nodeId:n,handleId:t,type:H},connectionEndHandle:null}),g?.(e,{nodeId:n,handleId:t,handleType:H});function F(z){const{transform:D}=r();_=Se(z,k);const{handle:R,validHandleResult:L}=ar(z,c,Ht(_,D,!1,[1,1]),w,P,Y=>Qn(Y,d,n,t,s?"target":"source",i,c));if(C=R,T||(Z(),T=!0),j=L.handleDomNode,M=L.connection,N=L.isValid,a({connectionPosition:C&&N?Gn({x:C.x,y:C.y},D):_,connectionStatus:lr(!!C,N),connectionEndHandle:L.endHandle}),!C&&!N&&!j)return kt(I);M.source!==M.target&&j&&(kt(I),I=j,j.classList.add("connecting","react-flow__handle-connecting"),j.classList.toggle("valid",N),j.classList.toggle("react-flow__handle-valid",N))}function S(z){(C||j)&&M&&N&&o?.(M),r().onConnectEnd?.(z),l&&u?.(z),kt(I),E(),cancelAnimationFrame(v),T=!1,N=!1,M=null,j=null,c.removeEventListener("mousemove",F),c.removeEventListener("mouseup",S),c.removeEventListener("touchmove",F),c.removeEventListener("touchend",S)}c.addEventListener("mousemove",F),c.addEventListener("mouseup",S),c.addEventListener("touchmove",F),c.addEventListener("touchend",S)}const mn=()=>!0,dr=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),ur=(e,t,n)=>o=>{const{connectionStartHandle:s,connectionEndHandle:r,connectionClickStartHandle:a}=o;return{connecting:s?.nodeId===e&&s?.handleId===t&&s?.type===n||r?.nodeId===e&&r?.handleId===t&&r?.type===n,clickConnecting:a?.nodeId===e&&a?.handleId===t&&a?.type===n}},to=p.forwardRef(({type:e="source",position:t=V.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:s=!0,isConnectableEnd:r=!0,id:a,onConnect:i,children:l,className:u,onMouseDown:c,onTouchStart:d,...m},h)=>{const w=a||null,g=e==="target",y=se(),b=nr(),{connectOnClick:E,noPanClassName:v}=J(dr,re),{connecting:C,clickConnecting:$}=J(ur(b,w,e),re);b||y.getState().onError?.("010",be.error010());const A=k=>{const{defaultEdgeOptions:I,onConnect:_,hasDefaultEdges:T}=y.getState(),M={...I,...k};if(T){const{edges:N,setEdges:j}=y.getState();j(Un(M,N))}_?.(M),i?.(M)},B=k=>{if(!b)return;const I=Ln(k);s&&(I&&k.button===0||!I)&&eo({event:k,handleId:w,nodeId:b,onConnect:A,isTarget:g,getState:y.getState,setState:y.setState,isValidConnection:n||y.getState().isValidConnection||mn}),I?c?.(k):d?.(k)},H=k=>{const{onClickConnectStart:I,onClickConnectEnd:_,connectionClickStartHandle:T,connectionMode:M,isValidConnection:N}=y.getState();if(!b||!T&&!s)return;if(!T){I?.(k,{nodeId:b,handleId:w,handleType:e}),y.setState({connectionClickStartHandle:{nodeId:b,type:e,handleId:w}});return}const j=zn(k.target),P=n||N||mn,{connection:Z,isValid:F}=Qn({nodeId:b,id:w,type:e},M,T.nodeId,T.handleId||null,T.type,P,j);F&&A(Z),_?.(k),y.setState({connectionClickStartHandle:null})};return x.createElement("div",{"data-handleid":w,"data-nodeid":b,"data-handlepos":t,"data-id":`${b}-${w}-${e}`,className:ie(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",v,u,{source:!g,target:g,connectable:o,connectablestart:s,connectableend:r,connecting:$,connectionindicator:o&&(s&&!C||r&&C)}]),onMouseDown:B,onTouchStart:B,onClick:E?H:void 0,ref:h,...m},l)});to.displayName="Handle";var mt=p.memo(to);const no=({data:e,isConnectable:t,targetPosition:n=V.Top,sourcePosition:o=V.Bottom})=>x.createElement(x.Fragment,null,x.createElement(mt,{type:"target",position:n,isConnectable:t}),e?.label,x.createElement(mt,{type:"source",position:o,isConnectable:t}));no.displayName="DefaultNode";var Rt=p.memo(no);const oo=({data:e,isConnectable:t,sourcePosition:n=V.Bottom})=>x.createElement(x.Fragment,null,e?.label,x.createElement(mt,{type:"source",position:n,isConnectable:t}));oo.displayName="InputNode";var so=p.memo(oo);const ro=({data:e,isConnectable:t,targetPosition:n=V.Top})=>x.createElement(x.Fragment,null,x.createElement(mt,{type:"target",position:n,isConnectable:t}),e?.label);ro.displayName="OutputNode";var ao=p.memo(ro);const Gt=()=>null;Gt.displayName="GroupNode";const fr=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),ct=e=>e.id;function hr(e,t){return re(e.selectedNodes.map(ct),t.selectedNodes.map(ct))&&re(e.selectedEdges.map(ct),t.selectedEdges.map(ct))}const io=p.memo(({onSelectionChange:e})=>{const t=se(),{selectedNodes:n,selectedEdges:o}=J(fr,hr);return p.useEffect(()=>{const s={nodes:n,edges:o};e?.(s),t.getState().onSelectionChange.forEach(r=>r(s))},[n,o,e]),null});io.displayName="SelectionListener";const mr=e=>!!e.onSelectionChange;function gr({onSelectionChange:e}){const t=J(mr);return e||t?x.createElement(io,{onSelectionChange:e}):null}const pr=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function Le(e,t){p.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function W(e,t,n){p.useEffect(()=>{typeof t<"u"&&n({[e]:t})},[t])}const xr=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:s,onConnectStart:r,onConnectEnd:a,onClickConnectStart:i,onClickConnectEnd:l,nodesDraggable:u,nodesConnectable:c,nodesFocusable:d,edgesFocusable:m,edgesUpdatable:h,elevateNodesOnSelect:w,minZoom:g,maxZoom:y,nodeExtent:b,onNodesChange:E,onEdgesChange:v,elementsSelectable:C,connectionMode:$,snapGrid:A,snapToGrid:B,translateExtent:H,connectOnClick:k,defaultEdgeOptions:I,fitView:_,fitViewOptions:T,onNodesDelete:M,onEdgesDelete:N,onNodeDrag:j,onNodeDragStart:P,onNodeDragStop:Z,onSelectionDrag:F,onSelectionDragStart:S,onSelectionDragStop:z,noPanClassName:D,nodeOrigin:R,rfId:L,autoPanOnConnect:Y,autoPanOnNodeDrag:U,onError:X,connectionRadius:ee,isValidConnection:ne,nodeDragThreshold:q})=>{const{setNodes:G,setEdges:ae,setDefaultNodesAndEdges:oe,setMinZoom:de,setMaxZoom:ce,setTranslateExtent:te,setNodeExtent:fe,reset:K}=J(pr,re),O=se();return p.useEffect(()=>{const ue=o?.map(xe=>({...xe,...I}));return oe(n,ue),()=>{K()}},[]),W("defaultEdgeOptions",I,O.setState),W("connectionMode",$,O.setState),W("onConnect",s,O.setState),W("onConnectStart",r,O.setState),W("onConnectEnd",a,O.setState),W("onClickConnectStart",i,O.setState),W("onClickConnectEnd",l,O.setState),W("nodesDraggable",u,O.setState),W("nodesConnectable",c,O.setState),W("nodesFocusable",d,O.setState),W("edgesFocusable",m,O.setState),W("edgesUpdatable",h,O.setState),W("elementsSelectable",C,O.setState),W("elevateNodesOnSelect",w,O.setState),W("snapToGrid",B,O.setState),W("snapGrid",A,O.setState),W("onNodesChange",E,O.setState),W("onEdgesChange",v,O.setState),W("connectOnClick",k,O.setState),W("fitViewOnInit",_,O.setState),W("fitViewOnInitOptions",T,O.setState),W("onNodesDelete",M,O.setState),W("onEdgesDelete",N,O.setState),W("onNodeDrag",j,O.setState),W("onNodeDragStart",P,O.setState),W("onNodeDragStop",Z,O.setState),W("onSelectionDrag",F,O.setState),W("onSelectionDragStart",S,O.setState),W("onSelectionDragStop",z,O.setState),W("noPanClassName",D,O.setState),W("nodeOrigin",R,O.setState),W("rfId",L,O.setState),W("autoPanOnConnect",Y,O.setState),W("autoPanOnNodeDrag",U,O.setState),W("onError",X,O.setState),W("connectionRadius",ee,O.setState),W("isValidConnection",ne,O.setState),W("nodeDragThreshold",q,O.setState),Le(e,G),Le(t,ae),Le(g,de),Le(y,ce),Le(H,te),Le(b,fe),null},gn={display:"none"},yr={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},co="react-flow__node-desc",lo="react-flow__edge-desc",br="react-flow__aria-live",wr=e=>e.ariaLiveMessage;function Er({rfId:e}){const t=J(wr);return x.createElement("div",{id:`${br}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:yr},t)}function Nr({rfId:e,disableKeyboardA11y:t}){return x.createElement(x.Fragment,null,x.createElement("div",{id:`${co}-${e}`,style:gn},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),x.createElement("div",{id:`${lo}-${e}`,style:gn},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&x.createElement(Er,{rfId:e}))}var rt=(e=null,t={actInsideInputWithModifier:!0})=>{const[n,o]=p.useState(!1),s=p.useRef(!1),r=p.useRef(new Set([])),[a,i]=p.useMemo(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(d=>typeof d=="string").map(d=>d.split("+")),c=u.reduce((d,m)=>d.concat(...m),[]);return[u,c]}return[[],[]]},[e]);return p.useEffect(()=>{const l=typeof document<"u"?document:null,u=t?.target||l;if(e!==null){const c=h=>{if(s.current=h.ctrlKey||h.metaKey||h.shiftKey,(!s.current||s.current&&!t.actInsideInputWithModifier)&&_t(h))return!1;const g=xn(h.code,i);r.current.add(h[g]),pn(a,r.current,!1)&&(h.preventDefault(),o(!0))},d=h=>{if((!s.current||s.current&&!t.actInsideInputWithModifier)&&_t(h))return!1;const g=xn(h.code,i);pn(a,r.current,!0)?(o(!1),r.current.clear()):r.current.delete(h[g]),h.key==="Meta"&&r.current.clear(),s.current=!1},m=()=>{r.current.clear(),o(!1)};return u?.addEventListener("keydown",c),u?.addEventListener("keyup",d),window.addEventListener("blur",m),()=>{u?.removeEventListener("keydown",c),u?.removeEventListener("keyup",d),window.removeEventListener("blur",m)}}},[e,o]),n};function pn(e,t,n){return e.filter(o=>n||o.length===t.size).some(o=>o.every(s=>t.has(s)))}function xn(e,t){return t.includes(e)?"code":"key"}function uo(e,t,n,o){const s=e.parentNode||e.parentId;if(!s)return n;const r=t.get(s),a=Te(r,o);return uo(r,t,{x:(n.x??0)+a.x,y:(n.y??0)+a.y,z:(r[Q]?.z??0)>(n.z??0)?r[Q]?.z??0:n.z??0},o)}function fo(e,t,n){e.forEach(o=>{const s=o.parentNode||o.parentId;if(s&&!e.has(s))throw new Error(`Parent node ${s} not found`);if(s||n?.[o.id]){const{x:r,y:a,z:i}=uo(o,e,{...o.position,z:o[Q]?.z??0},t);o.positionAbsolute={x:r,y:a},o[Q].z=i,n?.[o.id]&&(o[Q].isParent=!0)}})}function Ct(e,t,n,o){const s=new Map,r={},a=o?1e3:0;return e.forEach(i=>{const l=(he(i.zIndex)?i.zIndex:0)+(i.selected?a:0),u=t.get(i.id),c={...i,positionAbsolute:{x:i.position.x,y:i.position.y}},d=i.parentNode||i.parentId;d&&(r[d]=!0);const m=u?.type&&u?.type!==i.type;Object.defineProperty(c,Q,{enumerable:!1,value:{handleBounds:m?void 0:u?.[Q]?.handleBounds,z:l}}),s.set(i.id,c)}),fo(s,n,r),s}function ho(e,t={}){const{getNodes:n,width:o,height:s,minZoom:r,maxZoom:a,d3Zoom:i,d3Selection:l,fitViewOnInitDone:u,fitViewOnInit:c,nodeOrigin:d}=e(),m=t.initial&&!u&&c;if(i&&l&&(m||!t.initial)){const w=n().filter(y=>{const b=t.includeHiddenNodes?y.width&&y.height:!y.hidden;return t.nodes?.length?b&&t.nodes.some(E=>E.id===y.id):b}),g=w.every(y=>y.width&&y.height);if(w.length>0&&g){const y=xt(w,d),{x:b,y:E,zoom:v}=qn(y,o,s,t.minZoom??r,t.maxZoom??a,t.padding??.1),C=_e.translate(b,E).scale(v);return typeof t.duration=="number"&&t.duration>0?i.transform($e(l,t.duration),C):i.transform(l,C),!0}}return!1}function Sr(e,t){return e.forEach(n=>{const o=t.get(n.id);o&&t.set(o.id,{...o,[Q]:o[Q],selected:n.selected})}),new Map(t)}function vr(e,t){return t.map(n=>{const o=e.find(s=>s.id===n.id);return o&&(n.selected=o.selected),n})}function lt({changedNodes:e,changedEdges:t,get:n,set:o}){const{nodeInternals:s,edges:r,onNodesChange:a,onEdgesChange:i,hasDefaultNodes:l,hasDefaultEdges:u}=n();e?.length&&(l&&o({nodeInternals:Sr(e,s)}),a?.(e)),t?.length&&(u&&o({edges:vr(t,r)}),i?.(t))}const Fe=()=>{},kr={zoomIn:Fe,zoomOut:Fe,zoomTo:Fe,getZoom:()=>1,setViewport:Fe,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Fe,fitBounds:Fe,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},Cr=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),Mr=()=>{const e=se(),{d3Zoom:t,d3Selection:n}=J(Cr,re);return p.useMemo(()=>n&&t?{zoomIn:s=>t.scaleBy($e(n,s?.duration),1.2),zoomOut:s=>t.scaleBy($e(n,s?.duration),1/1.2),zoomTo:(s,r)=>t.scaleTo($e(n,r?.duration),s),getZoom:()=>e.getState().transform[2],setViewport:(s,r)=>{const[a,i,l]=e.getState().transform,u=_e.translate(s.x??a,s.y??i).scale(s.zoom??l);t.transform($e(n,r?.duration),u)},getViewport:()=>{const[s,r,a]=e.getState().transform;return{x:s,y:r,zoom:a}},fitView:s=>ho(e.getState,s),setCenter:(s,r,a)=>{const{width:i,height:l,maxZoom:u}=e.getState(),c=typeof a?.zoom<"u"?a.zoom:u,d=i/2-s*c,m=l/2-r*c,h=_e.translate(d,m).scale(c);t.transform($e(n,a?.duration),h)},fitBounds:(s,r)=>{const{width:a,height:i,minZoom:l,maxZoom:u}=e.getState(),{x:c,y:d,zoom:m}=qn(s,a,i,l,u,r?.padding??.1),h=_e.translate(c,d).scale(m);t.transform($e(n,r?.duration),h)},project:s=>{const{transform:r,snapToGrid:a,snapGrid:i}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Ht(s,r,a,i)},screenToFlowPosition:s=>{const{transform:r,snapToGrid:a,snapGrid:i,domNode:l}=e.getState();if(!l)return s;const{x:u,y:c}=l.getBoundingClientRect(),d={x:s.x-u,y:s.y-c};return Ht(d,r,a,i)},flowToScreenPosition:s=>{const{transform:r,domNode:a}=e.getState();if(!a)return s;const{x:i,y:l}=a.getBoundingClientRect(),u=Gn(s,r);return{x:u.x+i,y:u.y+l}},viewportInitialized:!0}:kr,[t,n])};function Xt(){const e=Mr(),t=se(),n=p.useCallback(()=>t.getState().getNodes().map(g=>({...g})),[]),o=p.useCallback(g=>t.getState().nodeInternals.get(g),[]),s=p.useCallback(()=>{const{edges:g=[]}=t.getState();return g.map(y=>({...y}))},[]),r=p.useCallback(g=>{const{edges:y=[]}=t.getState();return y.find(b=>b.id===g)},[]),a=p.useCallback(g=>{const{getNodes:y,setNodes:b,hasDefaultNodes:E,onNodesChange:v}=t.getState(),C=y(),$=typeof g=="function"?g(C):g;if(E)b($);else if(v){const A=$.length===0?C.map(B=>({type:"remove",id:B.id})):$.map(B=>({item:B,type:"reset"}));v(A)}},[]),i=p.useCallback(g=>{const{edges:y=[],setEdges:b,hasDefaultEdges:E,onEdgesChange:v}=t.getState(),C=typeof g=="function"?g(y):g;if(E)b(C);else if(v){const $=C.length===0?y.map(A=>({type:"remove",id:A.id})):C.map(A=>({item:A,type:"reset"}));v($)}},[]),l=p.useCallback(g=>{const y=Array.isArray(g)?g:[g],{getNodes:b,setNodes:E,hasDefaultNodes:v,onNodesChange:C}=t.getState();if(v){const A=[...b(),...y];E(A)}else if(C){const $=y.map(A=>({item:A,type:"add"}));C($)}},[]),u=p.useCallback(g=>{const y=Array.isArray(g)?g:[g],{edges:b=[],setEdges:E,hasDefaultEdges:v,onEdgesChange:C}=t.getState();if(v)E([...b,...y]);else if(C){const $=y.map(A=>({item:A,type:"add"}));C($)}},[]),c=p.useCallback(()=>{const{getNodes:g,edges:y=[],transform:b}=t.getState(),[E,v,C]=b;return{nodes:g().map($=>({...$})),edges:y.map($=>({...$})),viewport:{x:E,y:v,zoom:C}}},[]),d=p.useCallback(({nodes:g,edges:y})=>{const{nodeInternals:b,getNodes:E,edges:v,hasDefaultNodes:C,hasDefaultEdges:$,onNodesDelete:A,onEdgesDelete:B,onNodesChange:H,onEdgesChange:k}=t.getState(),I=(g||[]).map(j=>j.id),_=(y||[]).map(j=>j.id),T=E().reduce((j,P)=>{const Z=P.parentNode||P.parentId,F=!I.includes(P.id)&&Z&&j.find(z=>z.id===Z);return(typeof P.deletable=="boolean"?P.deletable:!0)&&(I.includes(P.id)||F)&&j.push(P),j},[]),M=v.filter(j=>typeof j.deletable=="boolean"?j.deletable:!0),N=M.filter(j=>_.includes(j.id));if(T||N){const j=Kn(T,M),P=[...N,...j],Z=P.reduce((F,S)=>(F.includes(S.id)||F.push(S.id),F),[]);if(($||C)&&($&&t.setState({edges:v.filter(F=>!Z.includes(F.id))}),C&&(T.forEach(F=>{b.delete(F.id)}),t.setState({nodeInternals:new Map(b)}))),Z.length>0&&(B?.(P),k&&k(Z.map(F=>({id:F,type:"remove"})))),T.length>0&&(A?.(T),H)){const F=T.map(S=>({id:S.id,type:"remove"}));H(F)}}},[]),m=p.useCallback(g=>{const y=Gs(g),b=y?null:t.getState().nodeInternals.get(g.id);return!y&&!b?[null,null,y]:[y?g:cn(b),b,y]},[]),h=p.useCallback((g,y=!0,b)=>{const[E,v,C]=m(g);return E?(b||t.getState().getNodes()).filter($=>{if(!C&&($.id===v.id||!$.positionAbsolute))return!1;const A=cn($),B=It(A,E);return y&&B>0||B>=E.width*E.height}):[]},[]),w=p.useCallback((g,y,b=!0)=>{const[E]=m(g);if(!E)return!1;const v=It(E,y);return b&&v>0||v>=E.width*E.height},[]);return p.useMemo(()=>({...e,getNodes:n,getNode:o,getEdges:s,getEdge:r,setNodes:a,setEdges:i,addNodes:l,addEdges:u,toObject:c,deleteElements:d,getIntersectingNodes:h,isNodeIntersecting:w}),[e,n,o,s,r,a,i,l,u,c,d,h,w])}const Ar={actInsideInputWithModifier:!1};var jr=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const n=se(),{deleteElements:o}=Xt(),s=rt(e,Ar),r=rt(t);p.useEffect(()=>{if(s){const{edges:a,getNodes:i}=n.getState(),l=i().filter(c=>c.selected),u=a.filter(c=>c.selected);o({nodes:l,edges:u}),n.setState({nodesSelectionActive:!1})}},[s]),p.useEffect(()=>{n.setState({multiSelectionActive:r})},[r])};function $r(e){const t=se();p.useEffect(()=>{let n;const o=()=>{if(!e.current)return;const s=Vt(e.current);(s.height===0||s.width===0)&&t.getState().onError?.("004",be.error004()),t.setState({width:s.width||500,height:s.height||500})};return o(),window.addEventListener("resize",o),e.current&&(n=new ResizeObserver(()=>o()),n.observe(e.current)),()=>{window.removeEventListener("resize",o),n&&e.current&&n.unobserve(e.current)}},[])}const Kt={position:"absolute",width:"100%",height:"100%",top:0,left:0},Ir=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,dt=e=>({x:e.x,y:e.y,zoom:e.k}),Ze=(e,t)=>e.target.closest(`.${t}`),yn=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),bn=e=>{const t=e.ctrlKey&&ut()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},_r=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),Tr=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:o,zoomOnScroll:s=!0,zoomOnPinch:r=!0,panOnScroll:a=!1,panOnScrollSpeed:i=.5,panOnScrollMode:l=Ie.Free,zoomOnDoubleClick:u=!0,elementsSelectable:c,panOnDrag:d=!0,defaultViewport:m,translateExtent:h,minZoom:w,maxZoom:g,zoomActivationKeyCode:y,preventScrolling:b=!0,children:E,noWheelClassName:v,noPanClassName:C})=>{const $=p.useRef(),A=se(),B=p.useRef(!1),H=p.useRef(!1),k=p.useRef(null),I=p.useRef({x:0,y:0,zoom:0}),{d3Zoom:_,d3Selection:T,d3ZoomHandler:M,userSelectionActive:N}=J(_r,re),j=rt(y),P=p.useRef(0),Z=p.useRef(!1),F=p.useRef();return $r(k),p.useEffect(()=>{if(k.current){const S=k.current.getBoundingClientRect(),z=Tn().scaleExtent([w,g]).translateExtent(h),D=Bt(k.current).call(z),R=_e.translate(m.x,m.y).scale(Ge(m.zoom,w,g)),L=[[0,0],[S.width,S.height]],Y=z.constrain()(R,L,h);z.transform(D,Y),z.wheelDelta(bn),A.setState({d3Zoom:z,d3Selection:D,d3ZoomHandler:D.on("wheel.zoom"),transform:[Y.x,Y.y,Y.k],domNode:k.current.closest(".react-flow")})}},[]),p.useEffect(()=>{T&&_&&(a&&!j&&!N?T.on("wheel.zoom",S=>{if(Ze(S,v))return!1;S.preventDefault(),S.stopImmediatePropagation();const z=T.property("__zoom").k||1;if(S.ctrlKey&&r){const ne=Dn(S),q=bn(S),G=z*Math.pow(2,q);_.scaleTo(T,G,ne,S);return}const D=S.deltaMode===1?20:1;let R=l===Ie.Vertical?0:S.deltaX*D,L=l===Ie.Horizontal?0:S.deltaY*D;!ut()&&S.shiftKey&&l!==Ie.Vertical&&(R=S.deltaY*D,L=0),_.translateBy(T,-(R/z)*i,-(L/z)*i,{internal:!0});const Y=dt(T.property("__zoom")),{onViewportChangeStart:U,onViewportChange:X,onViewportChangeEnd:ee}=A.getState();clearTimeout(F.current),Z.current||(Z.current=!0,t?.(S,Y),U?.(Y)),Z.current&&(e?.(S,Y),X?.(Y),F.current=setTimeout(()=>{n?.(S,Y),ee?.(Y),Z.current=!1},150))},{passive:!1}):typeof M<"u"&&T.on("wheel.zoom",function(S,z){if(!b&&S.type==="wheel"&&!S.ctrlKey||Ze(S,v))return null;S.preventDefault(),M.call(this,S,z)},{passive:!1}))},[N,a,l,T,_,M,j,r,b,v,t,e,n]),p.useEffect(()=>{_&&_.on("start",S=>{if(!S.sourceEvent||S.sourceEvent.internal)return null;P.current=S.sourceEvent?.button;const{onViewportChangeStart:z}=A.getState(),D=dt(S.transform);B.current=!0,I.current=D,S.sourceEvent?.type==="mousedown"&&A.setState({paneDragging:!0}),z?.(D),t?.(S.sourceEvent,D)})},[_,t]),p.useEffect(()=>{_&&(N&&!B.current?_.on("zoom",null):N||_.on("zoom",S=>{const{onViewportChange:z}=A.getState();if(A.setState({transform:[S.transform.x,S.transform.y,S.transform.k]}),H.current=!!(o&&yn(d,P.current??0)),(e||z)&&!S.sourceEvent?.internal){const D=dt(S.transform);z?.(D),e?.(S.sourceEvent,D)}}))},[N,_,e,d,o]),p.useEffect(()=>{_&&_.on("end",S=>{if(!S.sourceEvent||S.sourceEvent.internal)return null;const{onViewportChangeEnd:z}=A.getState();if(B.current=!1,A.setState({paneDragging:!1}),o&&yn(d,P.current??0)&&!H.current&&o(S.sourceEvent),H.current=!1,(n||z)&&Ir(I.current,S.transform)){const D=dt(S.transform);I.current=D,clearTimeout($.current),$.current=setTimeout(()=>{z?.(D),n?.(S.sourceEvent,D)},a?150:0)}})},[_,a,d,n,o]),p.useEffect(()=>{_&&_.filter(S=>{const z=j||s,D=r&&S.ctrlKey;if((d===!0||Array.isArray(d)&&d.includes(1))&&S.button===1&&S.type==="mousedown"&&(Ze(S,"react-flow__node")||Ze(S,"react-flow__edge")))return!0;if(!d&&!z&&!a&&!u&&!r||N||!u&&S.type==="dblclick"||Ze(S,v)&&S.type==="wheel"||Ze(S,C)&&(S.type!=="wheel"||a&&S.type==="wheel"&&!j)||!r&&S.ctrlKey&&S.type==="wheel"||!z&&!a&&!D&&S.type==="wheel"||!d&&(S.type==="mousedown"||S.type==="touchstart")||Array.isArray(d)&&!d.includes(S.button)&&S.type==="mousedown")return!1;const R=Array.isArray(d)&&d.includes(S.button)||!S.button||S.button<=1;return(!S.ctrlKey||S.type==="wheel")&&R})},[N,_,s,r,a,u,d,c,j]),x.createElement("div",{className:"react-flow__renderer",ref:k,style:Kt},E)},Dr=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Hr(){const{userSelectionActive:e,userSelectionRect:t}=J(Dr,re);return e&&t?x.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function wn(e,t){const n=t.parentNode||t.parentId,o=e.find(s=>s.id===n);if(o){const s=t.position.x+t.width-o.width,r=t.position.y+t.height-o.height;if(s>0||r>0||t.position.x<0||t.position.y<0){if(o.style={...o.style},o.style.width=o.style.width??o.width,o.style.height=o.style.height??o.height,s>0&&(o.style.width+=s),r>0&&(o.style.height+=r),t.position.x<0){const a=Math.abs(t.position.x);o.position.x=o.position.x-a,o.style.width+=a,t.position.x=0}if(t.position.y<0){const a=Math.abs(t.position.y);o.position.y=o.position.y-a,o.style.height+=a,t.position.y=0}o.width=o.style.width,o.height=o.style.height}}}function mo(e,t){if(e.some(o=>o.type==="reset"))return e.filter(o=>o.type==="reset").map(o=>o.item);const n=e.filter(o=>o.type==="add").map(o=>o.item);return t.reduce((o,s)=>{const r=e.filter(i=>i.id===s.id);if(r.length===0)return o.push(s),o;const a={...s};for(const i of r)if(i)switch(i.type){case"select":{a.selected=i.selected;break}case"position":{typeof i.position<"u"&&(a.position=i.position),typeof i.positionAbsolute<"u"&&(a.positionAbsolute=i.positionAbsolute),typeof i.dragging<"u"&&(a.dragging=i.dragging),a.expandParent&&wn(o,a);break}case"dimensions":{typeof i.dimensions<"u"&&(a.width=i.dimensions.width,a.height=i.dimensions.height),typeof i.updateStyle<"u"&&(a.style={...a.style||{},...i.dimensions}),typeof i.resizing=="boolean"&&(a.resizing=i.resizing),a.expandParent&&wn(o,a);break}case"remove":return o}return o.push(a),o},n)}function go(e,t){return mo(e,t)}function Rr(e,t){return mo(e,t)}const Ee=(e,t)=>({id:e,type:"select",selected:t});function We(e,t){return e.reduce((n,o)=>{const s=t.includes(o.id);return!o.selected&&s?(o.selected=!0,n.push(Ee(o.id,!0))):o.selected&&!s&&(o.selected=!1,n.push(Ee(o.id,!1))),n},[])}const Mt=(e,t)=>n=>{n.target===t.current&&e?.(n)},Pr=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),po=p.memo(({isSelecting:e,selectionMode:t=st.Full,panOnDrag:n,onSelectionStart:o,onSelectionEnd:s,onPaneClick:r,onPaneContextMenu:a,onPaneScroll:i,onPaneMouseEnter:l,onPaneMouseMove:u,onPaneMouseLeave:c,children:d})=>{const m=p.useRef(null),h=se(),w=p.useRef(0),g=p.useRef(0),y=p.useRef(),{userSelectionActive:b,elementsSelectable:E,dragging:v}=J(Pr,re),C=()=>{h.setState({userSelectionActive:!1,userSelectionRect:null}),w.current=0,g.current=0},$=M=>{r?.(M),h.getState().resetSelectedElements(),h.setState({nodesSelectionActive:!1})},A=M=>{if(Array.isArray(n)&&n?.includes(2)){M.preventDefault();return}a?.(M)},B=i?M=>i(M):void 0,H=M=>{const{resetSelectedElements:N,domNode:j}=h.getState();if(y.current=j?.getBoundingClientRect(),!E||!e||M.button!==0||M.target!==m.current||!y.current)return;const{x:P,y:Z}=Se(M,y.current);N(),h.setState({userSelectionRect:{width:0,height:0,startX:P,startY:Z,x:P,y:Z}}),o?.(M)},k=M=>{const{userSelectionRect:N,nodeInternals:j,edges:P,transform:Z,onNodesChange:F,onEdgesChange:S,nodeOrigin:z,getNodes:D}=h.getState();if(!e||!y.current||!N)return;h.setState({userSelectionActive:!0,nodesSelectionActive:!1});const R=Se(M,y.current),L=N.startX??0,Y=N.startY??0,U={...N,x:R.x<L?R.x:L,y:R.y<Y?R.y:Y,width:Math.abs(R.x-L),height:Math.abs(R.y-Y)},X=D(),ee=Xn(j,U,Z,t===st.Partial,!0,z),ne=Kn(ee,P).map(G=>G.id),q=ee.map(G=>G.id);if(w.current!==q.length){w.current=q.length;const G=We(X,q);G.length&&F?.(G)}if(g.current!==ne.length){g.current=ne.length;const G=We(P,ne);G.length&&S?.(G)}h.setState({userSelectionRect:U})},I=M=>{if(M.button!==0)return;const{userSelectionRect:N}=h.getState();!b&&N&&M.target===m.current&&$?.(M),h.setState({nodesSelectionActive:w.current>0}),C(),s?.(M)},_=M=>{b&&(h.setState({nodesSelectionActive:w.current>0}),s?.(M)),C()},T=E&&(e||b);return x.createElement("div",{className:ie(["react-flow__pane",{dragging:v,selection:e}]),onClick:T?void 0:Mt($,m),onContextMenu:Mt(A,m),onWheel:Mt(B,m),onMouseEnter:T?void 0:l,onMouseDown:T?H:void 0,onMouseMove:T?k:u,onMouseUp:T?I:void 0,onMouseLeave:T?_:c,ref:m,style:Kt},d,x.createElement(Hr,null))});po.displayName="Pane";function xo(e,t){const n=e.parentNode||e.parentId;if(!n)return!1;const o=t.get(n);return o?o.selected?!0:xo(o,t):!1}function En(e,t,n){let o=e;do{if(o?.matches(t))return!0;if(o===n.current)return!1;o=o.parentElement}while(o);return!1}function zr(e,t,n,o){return Array.from(e.values()).filter(s=>(s.selected||s.id===o)&&(!s.parentNode||s.parentId||!xo(s,e))&&(s.draggable||t&&typeof s.draggable>"u")).map(s=>({id:s.id,position:s.position||{x:0,y:0},positionAbsolute:s.positionAbsolute||{x:0,y:0},distance:{x:n.x-(s.positionAbsolute?.x??0),y:n.y-(s.positionAbsolute?.y??0)},delta:{x:0,y:0},extent:s.extent,parentNode:s.parentNode||s.parentId,parentId:s.parentNode||s.parentId,width:s.width,height:s.height,expandParent:s.expandParent}))}function Br(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function yo(e,t,n,o,s=[0,0],r){const a=Br(e,e.extent||o);let i=a;const l=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(l&&e.width&&e.height){const d=n.get(l),{x:m,y:h}=Te(d,s).positionAbsolute;i=d&&he(m)&&he(h)&&he(d.width)&&he(d.height)?[[m+e.width*s[0],h+e.height*s[1]],[m+d.width-e.width+e.width*s[0],h+d.height-e.height+e.height*s[1]]]:i}else r?.("005",be.error005()),i=a;else if(e.extent&&l&&e.extent!=="parent"){const d=n.get(l),{x:m,y:h}=Te(d,s).positionAbsolute;i=[[e.extent[0][0]+m,e.extent[0][1]+h],[e.extent[1][0]+m,e.extent[1][1]+h]]}let u={x:0,y:0};if(l){const d=n.get(l);u=Te(d,s).positionAbsolute}const c=i&&i!=="parent"?Lt(t,i):t;return{position:{x:c.x-u.x,y:c.y-u.y},positionAbsolute:c}}function At({nodeId:e,dragItems:t,nodeInternals:n}){const o=t.map(s=>({...n.get(s.id),position:s.position,positionAbsolute:s.positionAbsolute}));return[e?o.find(s=>s.id===e):o[0],o]}const Nn=(e,t,n,o)=>{const s=t.querySelectorAll(e);if(!s||!s.length)return null;const r=Array.from(s),a=t.getBoundingClientRect(),i={x:a.width*o[0],y:a.height*o[1]};return r.map(l=>{const u=l.getBoundingClientRect();return{id:l.getAttribute("data-handleid"),position:l.getAttribute("data-handlepos"),x:(u.left-a.left-i.x)/n,y:(u.top-a.top-i.y)/n,...Vt(l)}})};function et(e,t,n){return n===void 0?n:o=>{const s=t().nodeInternals.get(e);s&&n(o,{...s})}}function Pt({id:e,store:t,unselect:n=!1,nodeRef:o}){const{addSelectedNodes:s,unselectNodesAndEdges:r,multiSelectionActive:a,nodeInternals:i,onError:l}=t.getState(),u=i.get(e);if(!u){l?.("012",be.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(n||u.selected&&a)&&(r({nodes:[u],edges:[]}),requestAnimationFrame(()=>o?.current?.blur())):s([e])}function Or(){const e=se();return p.useCallback(({sourceEvent:n})=>{const{transform:o,snapGrid:s,snapToGrid:r}=e.getState(),a=n.touches?n.touches[0].clientX:n.clientX,i=n.touches?n.touches[0].clientY:n.clientY,l={x:(a-o[0])/o[2],y:(i-o[1])/o[2]};return{xSnapped:r?s[0]*Math.round(l.x/s[0]):l.x,ySnapped:r?s[1]*Math.round(l.y/s[1]):l.y,...l}},[])}function jt(e){return(t,n,o)=>e?.(t,o)}function bo({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:o,nodeId:s,isSelectable:r,selectNodesOnDrag:a}){const i=se(),[l,u]=p.useState(!1),c=p.useRef([]),d=p.useRef({x:null,y:null}),m=p.useRef(0),h=p.useRef(null),w=p.useRef({x:0,y:0}),g=p.useRef(null),y=p.useRef(!1),b=p.useRef(!1),E=p.useRef(!1),v=Or();return p.useEffect(()=>{if(e?.current){const C=Bt(e.current),$=({x:H,y:k})=>{const{nodeInternals:I,onNodeDrag:_,onSelectionDrag:T,updateNodePositions:M,nodeExtent:N,snapGrid:j,snapToGrid:P,nodeOrigin:Z,onError:F}=i.getState();d.current={x:H,y:k};let S=!1,z={x:0,y:0,x2:0,y2:0};if(c.current.length>1&&N){const R=xt(c.current,Z);z=ot(R)}if(c.current=c.current.map(R=>{const L={x:H-R.distance.x,y:k-R.distance.y};P&&(L.x=j[0]*Math.round(L.x/j[0]),L.y=j[1]*Math.round(L.y/j[1]));const Y=[[N[0][0],N[0][1]],[N[1][0],N[1][1]]];c.current.length>1&&N&&!R.extent&&(Y[0][0]=R.positionAbsolute.x-z.x+N[0][0],Y[1][0]=R.positionAbsolute.x+(R.width??0)-z.x2+N[1][0],Y[0][1]=R.positionAbsolute.y-z.y+N[0][1],Y[1][1]=R.positionAbsolute.y+(R.height??0)-z.y2+N[1][1]);const U=yo(R,L,I,Y,Z,F);return S=S||R.position.x!==U.position.x||R.position.y!==U.position.y,R.position=U.position,R.positionAbsolute=U.positionAbsolute,R}),!S)return;M(c.current,!0,!0),u(!0);const D=s?_:jt(T);if(D&&g.current){const[R,L]=At({nodeId:s,dragItems:c.current,nodeInternals:I});D(g.current,R,L)}},A=()=>{if(!h.current)return;const[H,k]=Pn(w.current,h.current);if(H!==0||k!==0){const{transform:I,panBy:_}=i.getState();d.current.x=(d.current.x??0)-H/I[2],d.current.y=(d.current.y??0)-k/I[2],_({x:H,y:k})&&$(d.current)}m.current=requestAnimationFrame(A)},B=H=>{const{nodeInternals:k,multiSelectionActive:I,nodesDraggable:_,unselectNodesAndEdges:T,onNodeDragStart:M,onSelectionDragStart:N}=i.getState();b.current=!0;const j=s?M:jt(N);(!a||!r)&&!I&&s&&(k.get(s)?.selected||T()),s&&r&&a&&Pt({id:s,store:i,nodeRef:e});const P=v(H);if(d.current=P,c.current=zr(k,_,P,s),j&&c.current){const[Z,F]=At({nodeId:s,dragItems:c.current,nodeInternals:k});j(H.sourceEvent,Z,F)}};if(t)C.on(".drag",null);else{const H=_s().on("start",k=>{const{domNode:I,nodeDragThreshold:_}=i.getState();_===0&&B(k),E.current=!1;const T=v(k);d.current=T,h.current=I?.getBoundingClientRect()||null,w.current=Se(k.sourceEvent,h.current)}).on("drag",k=>{const I=v(k),{autoPanOnNodeDrag:_,nodeDragThreshold:T}=i.getState();if(k.sourceEvent.type==="touchmove"&&k.sourceEvent.touches.length>1&&(E.current=!0),!E.current){if(!y.current&&b.current&&_&&(y.current=!0,A()),!b.current){const M=I.xSnapped-(d?.current?.x??0),N=I.ySnapped-(d?.current?.y??0);Math.sqrt(M*M+N*N)>T&&B(k)}(d.current.x!==I.xSnapped||d.current.y!==I.ySnapped)&&c.current&&b.current&&(g.current=k.sourceEvent,w.current=Se(k.sourceEvent,h.current),$(I))}}).on("end",k=>{if(!(!b.current||E.current)&&(u(!1),y.current=!1,b.current=!1,cancelAnimationFrame(m.current),c.current)){const{updateNodePositions:I,nodeInternals:_,onNodeDragStop:T,onSelectionDragStop:M}=i.getState(),N=s?T:jt(M);if(I(c.current,!1,!1),N){const[j,P]=At({nodeId:s,dragItems:c.current,nodeInternals:_});N(k.sourceEvent,j,P)}}}).filter(k=>{const I=k.target;return!k.button&&(!n||!En(I,`.${n}`,e))&&(!o||En(I,o,e))});return C.call(H),()=>{C.on(".drag",null)}}}},[e,t,n,o,r,i,s,a,v]),l}function wo(){const e=se();return p.useCallback(n=>{const{nodeInternals:o,nodeExtent:s,updateNodePositions:r,getNodes:a,snapToGrid:i,snapGrid:l,onError:u,nodesDraggable:c}=e.getState(),d=a().filter(E=>E.selected&&(E.draggable||c&&typeof E.draggable>"u")),m=i?l[0]:5,h=i?l[1]:5,w=n.isShiftPressed?4:1,g=n.x*m*w,y=n.y*h*w,b=d.map(E=>{if(E.positionAbsolute){const v={x:E.positionAbsolute.x+g,y:E.positionAbsolute.y+y};i&&(v.x=l[0]*Math.round(v.x/l[0]),v.y=l[1]*Math.round(v.y/l[1]));const{positionAbsolute:C,position:$}=yo(E,v,o,s,void 0,u);E.position=$,E.positionAbsolute=C}return E});r(b,!0,!1)},[])}const Ue={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var tt=e=>{const t=({id:n,type:o,data:s,xPos:r,yPos:a,xPosOrigin:i,yPosOrigin:l,selected:u,onClick:c,onMouseEnter:d,onMouseMove:m,onMouseLeave:h,onContextMenu:w,onDoubleClick:g,style:y,className:b,isDraggable:E,isSelectable:v,isConnectable:C,isFocusable:$,selectNodesOnDrag:A,sourcePosition:B,targetPosition:H,hidden:k,resizeObserver:I,dragHandle:_,zIndex:T,isParent:M,noDragClassName:N,noPanClassName:j,initialized:P,disableKeyboardA11y:Z,ariaLabel:F,rfId:S,hasHandleBounds:z})=>{const D=se(),R=p.useRef(null),L=p.useRef(null),Y=p.useRef(B),U=p.useRef(H),X=p.useRef(o),ee=v||E||c||d||m||h,ne=wo(),q=et(n,D.getState,d),G=et(n,D.getState,m),ae=et(n,D.getState,h),oe=et(n,D.getState,w),de=et(n,D.getState,g),ce=K=>{const{nodeDragThreshold:O}=D.getState();if(v&&(!A||!E||O>0)&&Pt({id:n,store:D,nodeRef:R}),c){const ue=D.getState().nodeInternals.get(n);ue&&c(K,{...ue})}},te=K=>{if(!_t(K)&&!Z)if(Vn.includes(K.key)&&v){const O=K.key==="Escape";Pt({id:n,store:D,unselect:O,nodeRef:R})}else E&&u&&Object.prototype.hasOwnProperty.call(Ue,K.key)&&(D.setState({ariaLiveMessage:`Moved selected node ${K.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~r}, y: ${~~a}`}),ne({x:Ue[K.key].x,y:Ue[K.key].y,isShiftPressed:K.shiftKey}))};p.useEffect(()=>()=>{L.current&&(I?.unobserve(L.current),L.current=null)},[]),p.useEffect(()=>{if(R.current&&!k){const K=R.current;(!P||!z||L.current!==K)&&(L.current&&I?.unobserve(L.current),I?.observe(K),L.current=K)}},[k,P,z]),p.useEffect(()=>{const K=X.current!==o,O=Y.current!==B,ue=U.current!==H;R.current&&(K||O||ue)&&(K&&(X.current=o),O&&(Y.current=B),ue&&(U.current=H),D.getState().updateNodeDimensions([{id:n,nodeElement:R.current,forceUpdate:!0}]))},[n,o,B,H]);const fe=bo({nodeRef:R,disabled:k||!E,noDragClassName:N,handleSelector:_,nodeId:n,isSelectable:v,selectNodesOnDrag:A});return k?null:x.createElement("div",{className:ie(["react-flow__node",`react-flow__node-${o}`,{[j]:E},b,{selected:u,selectable:v,parent:M,dragging:fe}]),ref:R,style:{zIndex:T,transform:`translate(${i}px,${l}px)`,pointerEvents:ee?"all":"none",visibility:P?"visible":"hidden",...y},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:q,onMouseMove:G,onMouseLeave:ae,onContextMenu:oe,onClick:ce,onDoubleClick:de,onKeyDown:$?te:void 0,tabIndex:$?0:void 0,role:$?"button":void 0,"aria-describedby":Z?void 0:`${co}-${S}`,"aria-label":F},x.createElement(tr,{value:n},x.createElement(e,{id:n,data:s,type:o,xPos:r,yPos:a,selected:u,isConnectable:C,sourcePosition:B,targetPosition:H,dragging:fe,dragHandle:_,zIndex:T})))};return t.displayName="NodeWrapper",p.memo(t)};const Vr=e=>{const t=e.getNodes().filter(n=>n.selected);return{...xt(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function Lr({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const o=se(),{width:s,height:r,x:a,y:i,transformString:l,userSelectionActive:u}=J(Vr,re),c=wo(),d=p.useRef(null);if(p.useEffect(()=>{n||d.current?.focus({preventScroll:!0})},[n]),bo({nodeRef:d}),u||!s||!r)return null;const m=e?w=>{const g=o.getState().getNodes().filter(y=>y.selected);e(w,g)}:void 0,h=w=>{Object.prototype.hasOwnProperty.call(Ue,w.key)&&c({x:Ue[w.key].x,y:Ue[w.key].y,isShiftPressed:w.shiftKey})};return x.createElement("div",{className:ie(["react-flow__nodesselection","react-flow__container",t]),style:{transform:l}},x.createElement("div",{ref:d,className:"react-flow__nodesselection-rect",onContextMenu:m,tabIndex:n?void 0:-1,onKeyDown:n?void 0:h,style:{width:s,height:r,top:i,left:a}}))}var Fr=p.memo(Lr);const Zr=e=>e.nodesSelectionActive,Eo=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:r,onPaneScroll:a,deleteKeyCode:i,onMove:l,onMoveStart:u,onMoveEnd:c,selectionKeyCode:d,selectionOnDrag:m,selectionMode:h,onSelectionStart:w,onSelectionEnd:g,multiSelectionKeyCode:y,panActivationKeyCode:b,zoomActivationKeyCode:E,elementsSelectable:v,zoomOnScroll:C,zoomOnPinch:$,panOnScroll:A,panOnScrollSpeed:B,panOnScrollMode:H,zoomOnDoubleClick:k,panOnDrag:I,defaultViewport:_,translateExtent:T,minZoom:M,maxZoom:N,preventScrolling:j,onSelectionContextMenu:P,noWheelClassName:Z,noPanClassName:F,disableKeyboardA11y:S})=>{const z=J(Zr),D=rt(d),R=rt(b),L=R||I,Y=R||A,U=D||m&&L!==!0;return jr({deleteKeyCode:i,multiSelectionKeyCode:y}),x.createElement(Tr,{onMove:l,onMoveStart:u,onMoveEnd:c,onPaneContextMenu:r,elementsSelectable:v,zoomOnScroll:C,zoomOnPinch:$,panOnScroll:Y,panOnScrollSpeed:B,panOnScrollMode:H,zoomOnDoubleClick:k,panOnDrag:!D&&L,defaultViewport:_,translateExtent:T,minZoom:M,maxZoom:N,zoomActivationKeyCode:E,preventScrolling:j,noWheelClassName:Z,noPanClassName:F},x.createElement(po,{onSelectionStart:w,onSelectionEnd:g,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:r,onPaneScroll:a,panOnDrag:L,isSelecting:!!U,selectionMode:h},e,z&&x.createElement(Fr,{onSelectionContextMenu:P,noPanClassName:F,disableKeyboardA11y:S})))};Eo.displayName="FlowRenderer";var Yr=p.memo(Eo);function Wr(e){return J(p.useCallback(n=>e?Xn(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[e]))}function Ur(e){const t={input:tt(e.input||so),default:tt(e.default||Rt),output:tt(e.output||ao),group:tt(e.group||Gt)},n={},o=Object.keys(e).filter(s=>!["input","default","output","group"].includes(s)).reduce((s,r)=>(s[r]=tt(e[r]||Rt),s),n);return{...t,...o}}const Gr=({x:e,y:t,width:n,height:o,origin:s})=>!n||!o?{x:e,y:t}:s[0]<0||s[1]<0||s[0]>1||s[1]>1?{x:e,y:t}:{x:e-n*s[0],y:t-o*s[1]},Xr=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),No=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:s,updateNodeDimensions:r,onError:a}=J(Xr,re),i=Wr(e.onlyRenderVisibleElements),l=p.useRef(),u=p.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const c=new ResizeObserver(d=>{const m=d.map(h=>({id:h.target.getAttribute("data-id"),nodeElement:h.target,forceUpdate:!0}));r(m)});return l.current=c,c},[]);return p.useEffect(()=>()=>{l?.current?.disconnect()},[]),x.createElement("div",{className:"react-flow__nodes",style:Kt},i.map(c=>{let d=c.type||"default";e.nodeTypes[d]||(a?.("003",be.error003(d)),d="default");const m=e.nodeTypes[d]||e.nodeTypes.default,h=!!(c.draggable||t&&typeof c.draggable>"u"),w=!!(c.selectable||s&&typeof c.selectable>"u"),g=!!(c.connectable||n&&typeof c.connectable>"u"),y=!!(c.focusable||o&&typeof c.focusable>"u"),b=e.nodeExtent?Lt(c.positionAbsolute,e.nodeExtent):c.positionAbsolute,E=b?.x??0,v=b?.y??0,C=Gr({x:E,y:v,width:c.width??0,height:c.height??0,origin:e.nodeOrigin});return x.createElement(m,{key:c.id,id:c.id,className:c.className,style:c.style,type:d,data:c.data,sourcePosition:c.sourcePosition||V.Bottom,targetPosition:c.targetPosition||V.Top,hidden:c.hidden,xPos:E,yPos:v,xPosOrigin:C.x,yPosOrigin:C.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!c.selected,isDraggable:h,isSelectable:w,isConnectable:g,isFocusable:y,resizeObserver:u,dragHandle:c.dragHandle,zIndex:c[Q]?.z??0,isParent:!!c[Q]?.isParent,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!c.width&&!!c.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:c.ariaLabel,hasHandleBounds:!!c[Q]?.handleBounds})}))};No.displayName="NodeRenderer";var Kr=p.memo(No);const qr=(e,t,n)=>n===V.Left?e-t:n===V.Right?e+t:e,Jr=(e,t,n)=>n===V.Top?e-t:n===V.Bottom?e+t:e,Sn="react-flow__edgeupdater",vn=({position:e,centerX:t,centerY:n,radius:o=10,onMouseDown:s,onMouseEnter:r,onMouseOut:a,type:i})=>x.createElement("circle",{onMouseDown:s,onMouseEnter:r,onMouseOut:a,className:ie([Sn,`${Sn}-${i}`]),cx:qr(t,o,e),cy:Jr(n,o,e),r:o,stroke:"transparent",fill:"transparent"}),Qr=()=>!0;var Ye=e=>{const t=({id:n,className:o,type:s,data:r,onClick:a,onEdgeDoubleClick:i,selected:l,animated:u,label:c,labelStyle:d,labelShowBg:m,labelBgStyle:h,labelBgPadding:w,labelBgBorderRadius:g,style:y,source:b,target:E,sourceX:v,sourceY:C,targetX:$,targetY:A,sourcePosition:B,targetPosition:H,elementsSelectable:k,hidden:I,sourceHandleId:_,targetHandleId:T,onContextMenu:M,onMouseEnter:N,onMouseMove:j,onMouseLeave:P,reconnectRadius:Z,onReconnect:F,onReconnectStart:S,onReconnectEnd:z,markerEnd:D,markerStart:R,rfId:L,ariaLabel:Y,isFocusable:U,isReconnectable:X,pathOptions:ee,interactionWidth:ne,disableKeyboardA11y:q})=>{const G=p.useRef(null),[ae,oe]=p.useState(!1),[de,ce]=p.useState(!1),te=se(),fe=p.useMemo(()=>`url('#${Dt(R,L)}')`,[R,L]),K=p.useMemo(()=>`url('#${Dt(D,L)}')`,[D,L]);if(I)return null;const O=le=>{const{edges:ge,addSelectedEdges:Ce,unselectNodesAndEdges:Me,multiSelectionActive:Oe}=te.getState(),pe=ge.find(Ae=>Ae.id===n);pe&&(k&&(te.setState({nodesSelectionActive:!1}),pe.selected&&Oe?(Me({nodes:[],edges:[pe]}),G.current?.blur()):Ce([n])),a&&a(le,pe))},ue=Qe(n,te.getState,i),xe=Qe(n,te.getState,M),Xe=Qe(n,te.getState,N),He=Qe(n,te.getState,j),Re=Qe(n,te.getState,P),ye=(le,ge)=>{if(le.button!==0)return;const{edges:Ce,isValidConnection:Me}=te.getState(),Oe=ge?E:b,pe=(ge?T:_)||null,Ae=ge?"target":"source",yt=Me||Qr,bt=ge,qe=Ce.find(je=>je.id===n);ce(!0),S?.(le,qe,Ae);const wt=je=>{ce(!1),z?.(je,qe,Ae)};eo({event:le,handleId:pe,nodeId:Oe,onConnect:je=>F?.(qe,je),isTarget:bt,getState:te.getState,setState:te.setState,isValidConnection:yt,edgeUpdaterType:Ae,onReconnectEnd:wt})},Pe=le=>ye(le,!0),ve=le=>ye(le,!1),ke=()=>oe(!0),ze=()=>oe(!1),Be=!k&&!a,Ke=le=>{if(!q&&Vn.includes(le.key)&&k){const{unselectNodesAndEdges:ge,addSelectedEdges:Ce,edges:Me}=te.getState();le.key==="Escape"?(G.current?.blur(),ge({edges:[Me.find(pe=>pe.id===n)]})):Ce([n])}};return x.createElement("g",{className:ie(["react-flow__edge",`react-flow__edge-${s}`,o,{selected:l,animated:u,inactive:Be,updating:ae}]),onClick:O,onDoubleClick:ue,onContextMenu:xe,onMouseEnter:Xe,onMouseMove:He,onMouseLeave:Re,onKeyDown:U?Ke:void 0,tabIndex:U?0:void 0,role:U?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":Y===null?void 0:Y||`Edge from ${b} to ${E}`,"aria-describedby":U?`${lo}-${L}`:void 0,ref:G},!de&&x.createElement(e,{id:n,source:b,target:E,selected:l,animated:u,label:c,labelStyle:d,labelShowBg:m,labelBgStyle:h,labelBgPadding:w,labelBgBorderRadius:g,data:r,style:y,sourceX:v,sourceY:C,targetX:$,targetY:A,sourcePosition:B,targetPosition:H,sourceHandleId:_,targetHandleId:T,markerStart:fe,markerEnd:K,pathOptions:ee,interactionWidth:ne}),X&&x.createElement(x.Fragment,null,(X==="source"||X===!0)&&x.createElement(vn,{position:B,centerX:v,centerY:C,radius:Z,onMouseDown:Pe,onMouseEnter:ke,onMouseOut:ze,type:"source"}),(X==="target"||X===!0)&&x.createElement(vn,{position:H,centerX:$,centerY:A,radius:Z,onMouseDown:ve,onMouseEnter:ke,onMouseOut:ze,type:"target"})))};return t.displayName="EdgeWrapper",p.memo(t)};function ea(e){const t={default:Ye(e.default||ht),straight:Ye(e.bezier||Yt),step:Ye(e.step||Zt),smoothstep:Ye(e.step||pt),simplebezier:Ye(e.simplebezier||Ft)},n={},o=Object.keys(e).filter(s=>!["default","bezier"].includes(s)).reduce((s,r)=>(s[r]=Ye(e[r]||ht),s),n);return{...t,...o}}function kn(e,t,n=null){const o=(n?.x||0)+t.x,s=(n?.y||0)+t.y,r=n?.width||t.width,a=n?.height||t.height;switch(e){case V.Top:return{x:o+r/2,y:s};case V.Right:return{x:o+r,y:s+a/2};case V.Bottom:return{x:o+r/2,y:s+a};case V.Left:return{x:o,y:s+a/2}}}function Cn(e,t){return e?e.length===1||!t?e[0]:t&&e.find(n=>n.id===t)||null:null}const ta=(e,t,n,o,s,r)=>{const a=kn(n,e,t),i=kn(r,o,s);return{sourceX:a.x,sourceY:a.y,targetX:i.x,targetY:i.y}};function na({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:o,targetWidth:s,targetHeight:r,width:a,height:i,transform:l}){const u={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+s),y2:Math.max(e.y+o,t.y+r)};u.x===u.x2&&(u.x2+=1),u.y===u.y2&&(u.y2+=1);const c=ot({x:(0-l[0])/l[2],y:(0-l[1])/l[2],width:a/l[2],height:i/l[2]}),d=Math.max(0,Math.min(c.x2,u.x2)-Math.max(c.x,u.x)),m=Math.max(0,Math.min(c.y2,u.y2)-Math.max(c.y,u.y));return Math.ceil(d*m)>0}function Mn(e){const t=e?.[Q]?.handleBounds||null,n=t&&e?.width&&e?.height&&typeof e?.positionAbsolute?.x<"u"&&typeof e?.positionAbsolute?.y<"u";return[{x:e?.positionAbsolute?.x||0,y:e?.positionAbsolute?.y||0,width:e?.width||0,height:e?.height||0},t,!!n]}const oa=[{level:0,isMaxLevel:!0,edges:[]}];function sa(e,t,n=!1){let o=-1;const s=e.reduce((a,i)=>{const l=he(i.zIndex);let u=l?i.zIndex:0;if(n){const c=t.get(i.target),d=t.get(i.source),m=i.selected||c?.selected||d?.selected,h=Math.max(d?.[Q]?.z||0,c?.[Q]?.z||0,1e3);u=(l?i.zIndex:0)+(m?h:0)}return a[u]?a[u].push(i):a[u]=[i],o=u>o?u:o,a},{}),r=Object.entries(s).map(([a,i])=>{const l=+a;return{edges:i,level:l,isMaxLevel:l===o}});return r.length===0?oa:r}function ra(e,t,n){const o=J(p.useCallback(s=>e?s.edges.filter(r=>{const a=t.get(r.source),i=t.get(r.target);return a?.width&&a?.height&&i?.width&&i?.height&&na({sourcePos:a.positionAbsolute||{x:0,y:0},targetPos:i.positionAbsolute||{x:0,y:0},sourceWidth:a.width,sourceHeight:a.height,targetWidth:i.width,targetHeight:i.height,width:s.width,height:s.height,transform:s.transform})}):s.edges,[e,t]));return sa(o,t,n)}const aa=({color:e="none",strokeWidth:t=1})=>x.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),ia=({color:e="none",strokeWidth:t=1})=>x.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),An={[ft.Arrow]:aa,[ft.ArrowClosed]:ia};function ca(e){const t=se();return p.useMemo(()=>Object.prototype.hasOwnProperty.call(An,e)?An[e]:(t.getState().onError?.("009",be.error009(e)),null),[e])}const la=({id:e,type:t,color:n,width:o=12.5,height:s=12.5,markerUnits:r="strokeWidth",strokeWidth:a,orient:i="auto-start-reverse"})=>{const l=ca(t);return l?x.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:r,orient:i,refX:"0",refY:"0"},x.createElement(l,{color:n,strokeWidth:a})):null},da=({defaultColor:e,rfId:t})=>n=>{const o=[];return n.edges.reduce((s,r)=>([r.markerStart,r.markerEnd].forEach(a=>{if(a&&typeof a=="object"){const i=Dt(a,t);o.includes(i)||(s.push({id:i,color:a.color||e,...a}),o.push(i))}}),s),[]).sort((s,r)=>s.id.localeCompare(r.id))},So=({defaultColor:e,rfId:t})=>{const n=J(p.useCallback(da({defaultColor:e,rfId:t}),[e,t]),(o,s)=>!(o.length!==s.length||o.some((r,a)=>r.id!==s[a].id)));return x.createElement("defs",null,n.map(o=>x.createElement(la,{id:o.id,key:o.id,type:o.type,color:o.color,width:o.width,height:o.height,markerUnits:o.markerUnits,strokeWidth:o.strokeWidth,orient:o.orient})))};So.displayName="MarkerDefinitions";var ua=p.memo(So);const fa=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),vo=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:o,edgeTypes:s,noPanClassName:r,onEdgeContextMenu:a,onEdgeMouseEnter:i,onEdgeMouseMove:l,onEdgeMouseLeave:u,onEdgeClick:c,onEdgeDoubleClick:d,onReconnect:m,onReconnectStart:h,onReconnectEnd:w,reconnectRadius:g,children:y,disableKeyboardA11y:b})=>{const{edgesFocusable:E,edgesUpdatable:v,elementsSelectable:C,width:$,height:A,connectionMode:B,nodeInternals:H,onError:k}=J(fa,re),I=ra(t,H,n);return $?x.createElement(x.Fragment,null,I.map(({level:_,edges:T,isMaxLevel:M})=>x.createElement("svg",{key:_,style:{zIndex:_},width:$,height:A,className:"react-flow__edges react-flow__container"},M&&x.createElement(ua,{defaultColor:e,rfId:o}),x.createElement("g",null,T.map(N=>{const[j,P,Z]=Mn(H.get(N.source)),[F,S,z]=Mn(H.get(N.target));if(!Z||!z)return null;let D=N.type||"default";s[D]||(k?.("011",be.error011(D)),D="default");const R=s[D]||s.default,L=B===De.Strict?S.target:(S.target??[]).concat(S.source??[]),Y=Cn(P.source,N.sourceHandle),U=Cn(L,N.targetHandle),X=Y?.position||V.Bottom,ee=U?.position||V.Top,ne=!!(N.focusable||E&&typeof N.focusable>"u"),q=N.reconnectable||N.updatable,G=typeof m<"u"&&(q||v&&typeof q>"u");if(!Y||!U)return k?.("008",be.error008(Y,N)),null;const{sourceX:ae,sourceY:oe,targetX:de,targetY:ce}=ta(j,Y,X,F,U,ee);return x.createElement(R,{key:N.id,id:N.id,className:ie([N.className,r]),type:D,data:N.data,selected:!!N.selected,animated:!!N.animated,hidden:!!N.hidden,label:N.label,labelStyle:N.labelStyle,labelShowBg:N.labelShowBg,labelBgStyle:N.labelBgStyle,labelBgPadding:N.labelBgPadding,labelBgBorderRadius:N.labelBgBorderRadius,style:N.style,source:N.source,target:N.target,sourceHandleId:N.sourceHandle,targetHandleId:N.targetHandle,markerEnd:N.markerEnd,markerStart:N.markerStart,sourceX:ae,sourceY:oe,targetX:de,targetY:ce,sourcePosition:X,targetPosition:ee,elementsSelectable:C,onContextMenu:a,onMouseEnter:i,onMouseMove:l,onMouseLeave:u,onClick:c,onEdgeDoubleClick:d,onReconnect:m,onReconnectStart:h,onReconnectEnd:w,reconnectRadius:g,rfId:o,ariaLabel:N.ariaLabel,isFocusable:ne,isReconnectable:G,pathOptions:"pathOptions"in N?N.pathOptions:void 0,interactionWidth:N.interactionWidth,disableKeyboardA11y:b})})))),y):null};vo.displayName="EdgeRenderer";var ha=p.memo(vo);const ma=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function ga({children:e}){const t=J(ma);return x.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function pa(e){const t=Xt(),n=p.useRef(!1);p.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const xa={[V.Left]:V.Right,[V.Right]:V.Left,[V.Top]:V.Bottom,[V.Bottom]:V.Top},ko=({nodeId:e,handleType:t,style:n,type:o=Ne.Bezier,CustomComponent:s,connectionStatus:r})=>{const{fromNode:a,handleId:i,toX:l,toY:u,connectionMode:c}=J(p.useCallback(A=>({fromNode:A.nodeInternals.get(e),handleId:A.connectionHandleId,toX:(A.connectionPosition.x-A.transform[0])/A.transform[2],toY:(A.connectionPosition.y-A.transform[1])/A.transform[2],connectionMode:A.connectionMode}),[e]),re),d=a?.[Q]?.handleBounds;let m=d?.[t];if(c===De.Loose&&(m=m||d?.[t==="source"?"target":"source"]),!a||!m)return null;const h=i?m.find(A=>A.id===i):m[0],w=h?h.x+h.width/2:(a.width??0)/2,g=h?h.y+h.height/2:a.height??0,y=(a.positionAbsolute?.x??0)+w,b=(a.positionAbsolute?.y??0)+g,E=h?.position,v=E?xa[E]:null;if(!E||!v)return null;if(s)return x.createElement(s,{connectionLineType:o,connectionLineStyle:n,fromNode:a,fromHandle:h,fromX:y,fromY:b,toX:l,toY:u,fromPosition:E,toPosition:v,connectionStatus:r});let C="";const $={sourceX:y,sourceY:b,sourcePosition:E,targetX:l,targetY:u,targetPosition:v};return o===Ne.Bezier?[C]=Wn($):o===Ne.Step?[C]=Tt({...$,borderRadius:0}):o===Ne.SmoothStep?[C]=Tt($):o===Ne.SimpleBezier?[C]=Yn($):C=`M${y},${b} ${l},${u}`,x.createElement("path",{d:C,fill:"none",className:"react-flow__connection-path",style:n})};ko.displayName="ConnectionLine";const ya=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function ba({containerStyle:e,style:t,type:n,component:o}){const{nodeId:s,handleType:r,nodesConnectable:a,width:i,height:l,connectionStatus:u}=J(ya,re);return!(s&&r&&i&&a)?null:x.createElement("svg",{style:e,width:i,height:l,className:"react-flow__edges react-flow__connectionline react-flow__container"},x.createElement("g",{className:ie(["react-flow__connection",u])},x.createElement(ko,{nodeId:s,handleType:r,style:t,type:n,CustomComponent:o,connectionStatus:u})))}function jn(e,t){return p.useRef(null),se(),p.useMemo(()=>t(e),[e])}const Co=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:o,onMoveEnd:s,onInit:r,onNodeClick:a,onEdgeClick:i,onNodeDoubleClick:l,onEdgeDoubleClick:u,onNodeMouseEnter:c,onNodeMouseMove:d,onNodeMouseLeave:m,onNodeContextMenu:h,onSelectionContextMenu:w,onSelectionStart:g,onSelectionEnd:y,connectionLineType:b,connectionLineStyle:E,connectionLineComponent:v,connectionLineContainerStyle:C,selectionKeyCode:$,selectionOnDrag:A,selectionMode:B,multiSelectionKeyCode:H,panActivationKeyCode:k,zoomActivationKeyCode:I,deleteKeyCode:_,onlyRenderVisibleElements:T,elementsSelectable:M,selectNodesOnDrag:N,defaultViewport:j,translateExtent:P,minZoom:Z,maxZoom:F,preventScrolling:S,defaultMarkerColor:z,zoomOnScroll:D,zoomOnPinch:R,panOnScroll:L,panOnScrollSpeed:Y,panOnScrollMode:U,zoomOnDoubleClick:X,panOnDrag:ee,onPaneClick:ne,onPaneMouseEnter:q,onPaneMouseMove:G,onPaneMouseLeave:ae,onPaneScroll:oe,onPaneContextMenu:de,onEdgeContextMenu:ce,onEdgeMouseEnter:te,onEdgeMouseMove:fe,onEdgeMouseLeave:K,onReconnect:O,onReconnectStart:ue,onReconnectEnd:xe,reconnectRadius:Xe,noDragClassName:He,noWheelClassName:Re,noPanClassName:ye,elevateEdgesOnSelect:Pe,disableKeyboardA11y:ve,nodeOrigin:ke,nodeExtent:ze,rfId:Be})=>{const Ke=jn(e,Ur),le=jn(t,ea);return pa(r),x.createElement(Yr,{onPaneClick:ne,onPaneMouseEnter:q,onPaneMouseMove:G,onPaneMouseLeave:ae,onPaneContextMenu:de,onPaneScroll:oe,deleteKeyCode:_,selectionKeyCode:$,selectionOnDrag:A,selectionMode:B,onSelectionStart:g,onSelectionEnd:y,multiSelectionKeyCode:H,panActivationKeyCode:k,zoomActivationKeyCode:I,elementsSelectable:M,onMove:n,onMoveStart:o,onMoveEnd:s,zoomOnScroll:D,zoomOnPinch:R,zoomOnDoubleClick:X,panOnScroll:L,panOnScrollSpeed:Y,panOnScrollMode:U,panOnDrag:ee,defaultViewport:j,translateExtent:P,minZoom:Z,maxZoom:F,onSelectionContextMenu:w,preventScrolling:S,noDragClassName:He,noWheelClassName:Re,noPanClassName:ye,disableKeyboardA11y:ve},x.createElement(ga,null,x.createElement(ha,{edgeTypes:le,onEdgeClick:i,onEdgeDoubleClick:u,onlyRenderVisibleElements:T,onEdgeContextMenu:ce,onEdgeMouseEnter:te,onEdgeMouseMove:fe,onEdgeMouseLeave:K,onReconnect:O,onReconnectStart:ue,onReconnectEnd:xe,reconnectRadius:Xe,defaultMarkerColor:z,noPanClassName:ye,elevateEdgesOnSelect:!!Pe,disableKeyboardA11y:ve,rfId:Be},x.createElement(ba,{style:E,type:b,component:v,containerStyle:C})),x.createElement("div",{className:"react-flow__edgelabel-renderer"}),x.createElement(Kr,{nodeTypes:Ke,onNodeClick:a,onNodeDoubleClick:l,onNodeMouseEnter:c,onNodeMouseMove:d,onNodeMouseLeave:m,onNodeContextMenu:h,selectNodesOnDrag:N,onlyRenderVisibleElements:T,noPanClassName:ye,noDragClassName:He,disableKeyboardA11y:ve,nodeOrigin:ke,nodeExtent:ze,rfId:Be})))};Co.displayName="GraphView";var wa=p.memo(Co);const zt=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],we={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:zt,nodeExtent:zt,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:De.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:Xs,isValidConnection:void 0},Ea=()=>Vs((e,t)=>({...we,setNodes:n=>{const{nodeInternals:o,nodeOrigin:s,elevateNodesOnSelect:r}=t();e({nodeInternals:Ct(n,o,s,r)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:o={}}=t();e({edges:n.map(s=>({...o,...s}))})},setDefaultNodesAndEdges:(n,o)=>{const s=typeof n<"u",r=typeof o<"u",a=s?Ct(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:a,edges:r?o:[],hasDefaultNodes:s,hasDefaultEdges:r})},updateNodeDimensions:n=>{const{onNodesChange:o,nodeInternals:s,fitViewOnInit:r,fitViewOnInitDone:a,fitViewOnInitOptions:i,domNode:l,nodeOrigin:u}=t(),c=l?.querySelector(".react-flow__viewport");if(!c)return;const d=window.getComputedStyle(c),{m22:m}=new window.DOMMatrixReadOnly(d.transform),h=n.reduce((g,y)=>{const b=s.get(y.id);if(b?.hidden)s.set(b.id,{...b,[Q]:{...b[Q],handleBounds:void 0}});else if(b){const E=Vt(y.nodeElement);!!(E.width&&E.height&&(b.width!==E.width||b.height!==E.height||y.forceUpdate))&&(s.set(b.id,{...b,[Q]:{...b[Q],handleBounds:{source:Nn(".source",y.nodeElement,m,u),target:Nn(".target",y.nodeElement,m,u)}},...E}),g.push({id:b.id,type:"dimensions",dimensions:E}))}return g},[]);fo(s,u);const w=a||r&&!a&&ho(t,{initial:!0,...i});e({nodeInternals:new Map(s),fitViewOnInitDone:w}),h?.length>0&&o?.(h)},updateNodePositions:(n,o=!0,s=!1)=>{const{triggerNodeChanges:r}=t(),a=n.map(i=>{const l={id:i.id,type:"position",dragging:s};return o&&(l.positionAbsolute=i.positionAbsolute,l.position=i.position),l});r(a)},triggerNodeChanges:n=>{const{onNodesChange:o,nodeInternals:s,hasDefaultNodes:r,nodeOrigin:a,getNodes:i,elevateNodesOnSelect:l}=t();if(n?.length){if(r){const u=go(n,i()),c=Ct(u,s,a,l);e({nodeInternals:c})}o?.(n)}},addSelectedNodes:n=>{const{multiSelectionActive:o,edges:s,getNodes:r}=t();let a,i=null;o?a=n.map(l=>Ee(l,!0)):(a=We(r(),n),i=We(s,[])),lt({changedNodes:a,changedEdges:i,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:o,edges:s,getNodes:r}=t();let a,i=null;o?a=n.map(l=>Ee(l,!0)):(a=We(s,n),i=We(r(),[])),lt({changedNodes:i,changedEdges:a,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:o}={})=>{const{edges:s,getNodes:r}=t(),a=n||r(),i=o||s,l=a.map(c=>(c.selected=!1,Ee(c.id,!1))),u=i.map(c=>Ee(c.id,!1));lt({changedNodes:l,changedEdges:u,get:t,set:e})},setMinZoom:n=>{const{d3Zoom:o,maxZoom:s}=t();o?.scaleExtent([n,s]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:o,minZoom:s}=t();o?.scaleExtent([s,n]),e({maxZoom:n})},setTranslateExtent:n=>{t().d3Zoom?.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:o}=t(),r=o().filter(i=>i.selected).map(i=>Ee(i.id,!1)),a=n.filter(i=>i.selected).map(i=>Ee(i.id,!1));lt({changedNodes:r,changedEdges:a,get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:o}=t();o.forEach(s=>{s.positionAbsolute=Lt(s.position,n)}),e({nodeExtent:n,nodeInternals:new Map(o)})},panBy:n=>{const{transform:o,width:s,height:r,d3Zoom:a,d3Selection:i,translateExtent:l}=t();if(!a||!i||!n.x&&!n.y)return!1;const u=_e.translate(o[0]+n.x,o[1]+n.y).scale(o[2]),c=[[0,0],[s,r]],d=a?.constrain()(u,c,l);return a.transform(i,d),o[0]!==d.x||o[1]!==d.y||o[2]!==d.k},cancelConnection:()=>e({connectionNodeId:we.connectionNodeId,connectionHandleId:we.connectionHandleId,connectionHandleType:we.connectionHandleType,connectionStatus:we.connectionStatus,connectionStartHandle:we.connectionStartHandle,connectionEndHandle:we.connectionEndHandle}),reset:()=>e({...we})}),Object.is),Mo=({children:e})=>{const t=p.useRef(null);return t.current||(t.current=Ea()),x.createElement(Ls,{value:t.current},e)};Mo.displayName="ReactFlowProvider";const Ao=({children:e})=>p.useContext(gt)?x.createElement(x.Fragment,null,e):x.createElement(Mo,null,e);Ao.displayName="ReactFlowWrapper";const Na={input:so,default:Rt,output:ao,group:Gt},Sa={default:ht,straight:Yt,step:Zt,smoothstep:pt,simplebezier:Ft},va=[0,0],ka=[15,15],Ca={x:0,y:0,zoom:1},Ma={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},jo=p.forwardRef(({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,className:s,nodeTypes:r=Na,edgeTypes:a=Sa,onNodeClick:i,onEdgeClick:l,onInit:u,onMove:c,onMoveStart:d,onMoveEnd:m,onConnect:h,onConnectStart:w,onConnectEnd:g,onClickConnectStart:y,onClickConnectEnd:b,onNodeMouseEnter:E,onNodeMouseMove:v,onNodeMouseLeave:C,onNodeContextMenu:$,onNodeDoubleClick:A,onNodeDragStart:B,onNodeDrag:H,onNodeDragStop:k,onNodesDelete:I,onEdgesDelete:_,onSelectionChange:T,onSelectionDragStart:M,onSelectionDrag:N,onSelectionDragStop:j,onSelectionContextMenu:P,onSelectionStart:Z,onSelectionEnd:F,connectionMode:S=De.Strict,connectionLineType:z=Ne.Bezier,connectionLineStyle:D,connectionLineComponent:R,connectionLineContainerStyle:L,deleteKeyCode:Y="Backspace",selectionKeyCode:U="Shift",selectionOnDrag:X=!1,selectionMode:ee=st.Full,panActivationKeyCode:ne="Space",multiSelectionKeyCode:q=ut()?"Meta":"Control",zoomActivationKeyCode:G=ut()?"Meta":"Control",snapToGrid:ae=!1,snapGrid:oe=ka,onlyRenderVisibleElements:de=!1,selectNodesOnDrag:ce=!0,nodesDraggable:te,nodesConnectable:fe,nodesFocusable:K,nodeOrigin:O=va,edgesFocusable:ue,edgesUpdatable:xe,elementsSelectable:Xe,defaultViewport:He=Ca,minZoom:Re=.5,maxZoom:ye=2,translateExtent:Pe=zt,preventScrolling:ve=!0,nodeExtent:ke,defaultMarkerColor:ze="#b1b1b7",zoomOnScroll:Be=!0,zoomOnPinch:Ke=!0,panOnScroll:le=!1,panOnScrollSpeed:ge=.5,panOnScrollMode:Ce=Ie.Free,zoomOnDoubleClick:Me=!0,panOnDrag:Oe=!0,onPaneClick:pe,onPaneMouseEnter:Ae,onPaneMouseMove:yt,onPaneMouseLeave:bt,onPaneScroll:qe,onPaneContextMenu:wt,children:qt,onEdgeContextMenu:je,onEdgeDoubleClick:Ho,onEdgeMouseEnter:Ro,onEdgeMouseMove:Po,onEdgeMouseLeave:zo,onEdgeUpdate:Bo,onEdgeUpdateStart:Oo,onEdgeUpdateEnd:Vo,onReconnect:Lo,onReconnectStart:Fo,onReconnectEnd:Zo,reconnectRadius:Yo=10,edgeUpdaterRadius:Wo=10,onNodesChange:Uo,onEdgesChange:Go,noDragClassName:Xo="nodrag",noWheelClassName:Ko="nowheel",noPanClassName:Jt="nopan",fitView:qo=!1,fitViewOptions:Jo,connectOnClick:Qo=!0,attributionPosition:es,proOptions:ts,defaultEdgeOptions:ns,elevateNodesOnSelect:os=!0,elevateEdgesOnSelect:ss=!1,disableKeyboardA11y:Qt=!1,autoPanOnConnect:rs=!0,autoPanOnNodeDrag:as=!0,connectionRadius:is=20,isValidConnection:cs,onError:ls,style:ds,id:en,nodeDragThreshold:us,...fs},hs)=>{const Et=en||"1";return x.createElement("div",{...fs,style:{...ds,...Ma},ref:hs,className:ie(["react-flow",s]),"data-testid":"rf__wrapper",id:en},x.createElement(Ao,null,x.createElement(wa,{onInit:u,onMove:c,onMoveStart:d,onMoveEnd:m,onNodeClick:i,onEdgeClick:l,onNodeMouseEnter:E,onNodeMouseMove:v,onNodeMouseLeave:C,onNodeContextMenu:$,onNodeDoubleClick:A,nodeTypes:r,edgeTypes:a,connectionLineType:z,connectionLineStyle:D,connectionLineComponent:R,connectionLineContainerStyle:L,selectionKeyCode:U,selectionOnDrag:X,selectionMode:ee,deleteKeyCode:Y,multiSelectionKeyCode:q,panActivationKeyCode:ne,zoomActivationKeyCode:G,onlyRenderVisibleElements:de,selectNodesOnDrag:ce,defaultViewport:He,translateExtent:Pe,minZoom:Re,maxZoom:ye,preventScrolling:ve,zoomOnScroll:Be,zoomOnPinch:Ke,zoomOnDoubleClick:Me,panOnScroll:le,panOnScrollSpeed:ge,panOnScrollMode:Ce,panOnDrag:Oe,onPaneClick:pe,onPaneMouseEnter:Ae,onPaneMouseMove:yt,onPaneMouseLeave:bt,onPaneScroll:qe,onPaneContextMenu:wt,onSelectionContextMenu:P,onSelectionStart:Z,onSelectionEnd:F,onEdgeContextMenu:je,onEdgeDoubleClick:Ho,onEdgeMouseEnter:Ro,onEdgeMouseMove:Po,onEdgeMouseLeave:zo,onReconnect:Lo??Bo,onReconnectStart:Fo??Oo,onReconnectEnd:Zo??Vo,reconnectRadius:Yo??Wo,defaultMarkerColor:ze,noDragClassName:Xo,noWheelClassName:Ko,noPanClassName:Jt,elevateEdgesOnSelect:ss,rfId:Et,disableKeyboardA11y:Qt,nodeOrigin:O,nodeExtent:ke}),x.createElement(xr,{nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:h,onConnectStart:w,onConnectEnd:g,onClickConnectStart:y,onClickConnectEnd:b,nodesDraggable:te,nodesConnectable:fe,nodesFocusable:K,edgesFocusable:ue,edgesUpdatable:xe,elementsSelectable:Xe,elevateNodesOnSelect:os,minZoom:Re,maxZoom:ye,nodeExtent:ke,onNodesChange:Uo,onEdgesChange:Go,snapToGrid:ae,snapGrid:oe,connectionMode:S,translateExtent:Pe,connectOnClick:Qo,defaultEdgeOptions:ns,fitView:qo,fitViewOptions:Jo,onNodesDelete:I,onEdgesDelete:_,onNodeDragStart:B,onNodeDrag:H,onNodeDragStop:k,onSelectionDrag:N,onSelectionDragStart:M,onSelectionDragStop:j,noPanClassName:Jt,nodeOrigin:O,rfId:Et,autoPanOnConnect:rs,autoPanOnNodeDrag:as,onError:ls,connectionRadius:is,isValidConnection:cs,nodeDragThreshold:us}),x.createElement(gr,{onSelectionChange:T}),qt,x.createElement(Zs,{proOptions:ts,position:es}),x.createElement(Nr,{rfId:Et,disableKeyboardA11y:Qt})))});jo.displayName="ReactFlow";function $o(e){return t=>{const[n,o]=p.useState(t),s=p.useCallback(r=>o(a=>e(r,a)),[]);return[n,o,s]}}const Aa=$o(go),ja=$o(Rr),Io=({id:e,x:t,y:n,width:o,height:s,style:r,color:a,strokeColor:i,strokeWidth:l,className:u,borderRadius:c,shapeRendering:d,onClick:m,selected:h})=>{const{background:w,backgroundColor:g}=r||{},y=a||w||g;return x.createElement("rect",{className:ie(["react-flow__minimap-node",{selected:h},u]),x:t,y:n,rx:c,ry:c,width:o,height:s,fill:y,stroke:i,strokeWidth:l,shapeRendering:d,onClick:m?b=>m(b,e):void 0})};Io.displayName="MiniMapNode";var $a=p.memo(Io);const Ia=e=>e.nodeOrigin,_a=e=>e.getNodes().filter(t=>!t.hidden&&t.width&&t.height),$t=e=>e instanceof Function?e:()=>e;function Ta({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:n="",nodeBorderRadius:o=5,nodeStrokeWidth:s=2,nodeComponent:r=$a,onClick:a}){const i=J(_a,re),l=J(Ia),u=$t(t),c=$t(e),d=$t(n),m=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return x.createElement(x.Fragment,null,i.map(h=>{const{x:w,y:g}=Te(h,l).positionAbsolute;return x.createElement(r,{key:h.id,x:w,y:g,width:h.width,height:h.height,style:h.style,selected:h.selected,className:d(h),color:u(h),borderRadius:o,strokeColor:c(h),strokeWidth:s,shapeRendering:m,onClick:a,id:h.id})}))}var Da=p.memo(Ta);const Ha=200,Ra=150,Pa=e=>{const t=e.getNodes(),n={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:n,boundingRect:t.length>0?Us(xt(t,e.nodeOrigin),n):n,rfId:e.rfId}},za="react-flow__minimap-desc";function _o({style:e,className:t,nodeStrokeColor:n="transparent",nodeColor:o="#e2e2e2",nodeClassName:s="",nodeBorderRadius:r=5,nodeStrokeWidth:a=2,nodeComponent:i,maskColor:l="rgb(240, 240, 240, 0.6)",maskStrokeColor:u="none",maskStrokeWidth:c=1,position:d="bottom-right",onClick:m,onNodeClick:h,pannable:w=!1,zoomable:g=!1,ariaLabel:y="React Flow mini map",inversePan:b=!1,zoomStep:E=10,offsetScale:v=5}){const C=se(),$=p.useRef(null),{boundingRect:A,viewBB:B,rfId:H}=J(Pa,re),k=e?.width??Ha,I=e?.height??Ra,_=A.width/k,T=A.height/I,M=Math.max(_,T),N=M*k,j=M*I,P=v*M,Z=A.x-(N-A.width)/2-P,F=A.y-(j-A.height)/2-P,S=N+P*2,z=j+P*2,D=`${za}-${H}`,R=p.useRef(0);R.current=M,p.useEffect(()=>{if($.current){const U=Bt($.current),X=q=>{const{transform:G,d3Selection:ae,d3Zoom:oe}=C.getState();if(q.sourceEvent.type!=="wheel"||!ae||!oe)return;const de=-q.sourceEvent.deltaY*(q.sourceEvent.deltaMode===1?.05:q.sourceEvent.deltaMode?1:.002)*E,ce=G[2]*Math.pow(2,de);oe.scaleTo(ae,ce)},ee=q=>{const{transform:G,d3Selection:ae,d3Zoom:oe,translateExtent:de,width:ce,height:te}=C.getState();if(q.sourceEvent.type!=="mousemove"||!ae||!oe)return;const fe=R.current*Math.max(1,G[2])*(b?-1:1),K={x:G[0]-q.sourceEvent.movementX*fe,y:G[1]-q.sourceEvent.movementY*fe},O=[[0,0],[ce,te]],ue=_e.translate(K.x,K.y).scale(G[2]),xe=oe.constrain()(ue,O,de);oe.transform(ae,xe)},ne=Tn().on("zoom",w?ee:null).on("zoom.wheel",g?X:null);return U.call(ne),()=>{U.on("zoom",null)}}},[w,g,b,E]);const L=m?U=>{const X=Dn(U);m(U,{x:X[0],y:X[1]})}:void 0,Y=h?(U,X)=>{const ee=C.getState().nodeInternals.get(X);h(U,ee)}:void 0;return x.createElement(Ot,{position:d,style:e,className:ie(["react-flow__minimap",t]),"data-testid":"rf__minimap"},x.createElement("svg",{width:k,height:I,viewBox:`${Z} ${F} ${S} ${z}`,role:"img","aria-labelledby":D,ref:$,onClick:L},y&&x.createElement("title",{id:D},y),x.createElement(Da,{onClick:Y,nodeColor:o,nodeStrokeColor:n,nodeBorderRadius:r,nodeClassName:s,nodeStrokeWidth:a,nodeComponent:i}),x.createElement("path",{className:"react-flow__minimap-mask",d:`M${Z-P},${F-P}h${S+P*2}v${z+P*2}h${-S-P*2}z
        M${B.x},${B.y}h${B.width}v${B.height}h${-B.width}z`,fill:l,fillRule:"evenodd",stroke:u,strokeWidth:c,pointerEvents:"none"})))}_o.displayName="MiniMap";var Ba=p.memo(_o);function Oa(){return x.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},x.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function Va(){return x.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},x.createElement("path",{d:"M0 0h32v4.2H0z"}))}function La(){return x.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},x.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function Fa(){return x.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},x.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function Za(){return x.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},x.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const nt=({children:e,className:t,...n})=>x.createElement("button",{type:"button",className:ie(["react-flow__controls-button",t]),...n},e);nt.displayName="ControlButton";const Ya=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),To=({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:o=!0,fitViewOptions:s,onZoomIn:r,onZoomOut:a,onFitView:i,onInteractiveChange:l,className:u,children:c,position:d="bottom-left"})=>{const m=se(),[h,w]=p.useState(!1),{isInteractive:g,minZoomReached:y,maxZoomReached:b}=J(Ya,re),{zoomIn:E,zoomOut:v,fitView:C}=Xt();if(p.useEffect(()=>{w(!0)},[]),!h)return null;const $=()=>{E(),r?.()},A=()=>{v(),a?.()},B=()=>{C(s),i?.()},H=()=>{m.setState({nodesDraggable:!g,nodesConnectable:!g,elementsSelectable:!g}),l?.(!g)};return x.createElement(Ot,{className:ie(["react-flow__controls",u]),position:d,style:e,"data-testid":"rf__controls"},t&&x.createElement(x.Fragment,null,x.createElement(nt,{onClick:$,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:b},x.createElement(Oa,null)),x.createElement(nt,{onClick:A,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:y},x.createElement(Va,null))),n&&x.createElement(nt,{className:"react-flow__controls-fitview",onClick:B,title:"fit view","aria-label":"fit view"},x.createElement(La,null)),o&&x.createElement(nt,{className:"react-flow__controls-interactive",onClick:H,title:"toggle interactivity","aria-label":"toggle interactivity"},g?x.createElement(Za,null):x.createElement(Fa,null)),c)};To.displayName="Controls";var Wa=p.memo(To),me;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(me||(me={}));function Ua({color:e,dimensions:t,lineWidth:n}){return x.createElement("path",{stroke:e,strokeWidth:n,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function Ga({color:e,radius:t}){return x.createElement("circle",{cx:t,cy:t,r:t,fill:e})}const Xa={[me.Dots]:"#91919a",[me.Lines]:"#eee",[me.Cross]:"#e2e2e2"},Ka={[me.Dots]:1,[me.Lines]:1,[me.Cross]:6},qa=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Do({id:e,variant:t=me.Dots,gap:n=20,size:o,lineWidth:s=1,offset:r=2,color:a,style:i,className:l}){const u=p.useRef(null),{transform:c,patternId:d}=J(qa,re),m=a||Xa[t],h=o||Ka[t],w=t===me.Dots,g=t===me.Cross,y=Array.isArray(n)?n:[n,n],b=[y[0]*c[2]||1,y[1]*c[2]||1],E=h*c[2],v=g?[E,E]:b,C=w?[E/r,E/r]:[v[0]/r,v[1]/r];return x.createElement("svg",{className:ie(["react-flow__background",l]),style:{...i,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:u,"data-testid":"rf__background"},x.createElement("pattern",{id:d+e,x:c[0]%b[0],y:c[1]%b[1],width:b[0],height:b[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${C[0]},-${C[1]})`},w?x.createElement(Ga,{color:m,radius:E/r}):x.createElement(Ua,{dimensions:v,color:m,lineWidth:s})),x.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${d+e})`}))}Do.displayName="Background";var Ja=p.memo(Do);const Qa=[{id:"1",position:{x:250,y:0},data:{label:"Subject: John Doe"},style:{background:"#dbeafe",border:"1px solid #2563eb",width:180}},{id:"2",position:{x:100,y:100},data:{label:"Account: 1234"}},{id:"3",position:{x:400,y:100},data:{label:"Company: Shell Corp"}},{id:"4",position:{x:400,y:200},data:{label:"Director: Jane Smith"}}],ei=[{id:"e1-2",source:"1",target:"2",animated:!0},{id:"e1-3",source:"1",target:"3"},{id:"e3-4",source:"3",target:"4"}];function ti(){const[e,,t]=Aa(Qa),[n,o,s]=ja(ei),r=p.useCallback(a=>o(i=>Un(a,i)),[o]);return f.jsx("div",{className:"h-[500px] w-full rounded-lg border border-slate-200 bg-slate-50 dark:border-slate-700 dark:bg-slate-900",children:f.jsxs(jo,{nodes:e,edges:n,onNodesChange:t,onEdgesChange:s,onConnect:r,fitView:!0,children:[f.jsx(Wa,{}),f.jsx(Ba,{}),f.jsx(Ja,{gap:12,size:1})]})})}const ni=[{date:"2024-03-01",transactions:12,risk:2},{date:"2024-03-02",transactions:19,risk:5},{date:"2024-03-03",transactions:8,risk:1},{date:"2024-03-04",transactions:25,risk:8},{date:"2024-03-05",transactions:15,risk:3},{date:"2024-03-06",transactions:22,risk:6},{date:"2024-03-07",transactions:30,risk:10}];function $n(){return f.jsxs("div",{className:"h-[400px] w-full rounded-lg border border-slate-200 bg-white p-4 shadow-sm dark:border-slate-700 dark:bg-slate-800",children:[f.jsx("h3",{className:"mb-4 text-lg font-medium text-slate-900 dark:text-white",children:"Transaction Timeline"}),f.jsx(ks,{width:"100%",height:"100%",children:f.jsxs(Cs,{data:ni,margin:{top:20,right:30,left:20,bottom:5},children:[f.jsx(Ms,{strokeDasharray:"3 3",className:"stroke-slate-200 dark:stroke-slate-700"}),f.jsx(As,{dataKey:"date",className:"text-xs text-slate-500 dark:text-slate-400",tick:{fill:"currentColor"}}),f.jsx(js,{className:"text-xs text-slate-500 dark:text-slate-400",tick:{fill:"currentColor"}}),f.jsx($s,{contentStyle:{backgroundColor:"rgba(255, 255, 255, 0.9)",borderRadius:"8px",border:"1px solid #e2e8f0",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},itemStyle:{color:"#1e293b"}}),f.jsx(Is,{}),f.jsx(on,{dataKey:"transactions",name:"Total Transactions",fill:"#3b82f6",radius:[4,4,0,0]}),f.jsx(on,{dataKey:"risk",name:"High Risk Events",fill:"#ef4444",radius:[4,4,0,0]})]})})]})}function oi(){return f.jsxs("div",{className:"h-[400px] w-full rounded-lg border border-slate-200 bg-white p-4 shadow-sm dark:border-slate-700 dark:bg-slate-800",children:[f.jsx("h3",{className:"mb-4 text-lg font-medium text-slate-900 dark:text-white",children:"Financial Flow"}),f.jsx("div",{className:"flex h-full items-center justify-center text-slate-500 dark:text-slate-400",children:f.jsxs("div",{className:"text-center",children:[f.jsxs("svg",{className:"mx-auto h-48 w-full max-w-lg",viewBox:"0 0 800 400",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[f.jsx("rect",{x:"50",y:"50",width:"20",height:"100",fill:"#3b82f6",rx:"4"}),f.jsx("text",{x:"40",y:"100",textAnchor:"end",className:"fill-slate-900 text-sm font-medium dark:fill-white",children:"Income"}),f.jsx("rect",{x:"50",y:"250",width:"20",height:"100",fill:"#10b981",rx:"4"}),f.jsx("text",{x:"40",y:"300",textAnchor:"end",className:"fill-slate-900 text-sm font-medium dark:fill-white",children:"Investments"}),f.jsx("rect",{x:"730",y:"100",width:"20",height:"80",fill:"#ef4444",rx:"4"}),f.jsx("text",{x:"760",y:"140",textAnchor:"start",className:"fill-slate-900 text-sm font-medium dark:fill-white",children:"Expenses"}),f.jsx("rect",{x:"730",y:"220",width:"20",height:"80",fill:"#f59e0b",rx:"4"}),f.jsx("text",{x:"760",y:"260",textAnchor:"start",className:"fill-slate-900 text-sm font-medium dark:fill-white",children:"Savings"}),f.jsx("path",{d:"M 70 100 C 400 100, 400 140, 730 140",stroke:"#3b82f6",strokeWidth:"40",strokeOpacity:"0.2",fill:"none"}),f.jsx("path",{d:"M 70 300 C 400 300, 400 260, 730 260",stroke:"#10b981",strokeWidth:"40",strokeOpacity:"0.2",fill:"none"})]}),f.jsx("p",{className:"mt-4 text-sm",children:"Simplified Visualization (Sankey placeholder)"})]})})]})}const si=[{name:"Overview",id:"overview",icon:Es},{name:"Graph Analysis",id:"graph",icon:Ns},{name:"Timeline",id:"timeline",icon:In},{name:"Financials",id:"financials",icon:Ss},{name:"Evidence",id:"evidence",icon:_n}];function hi(){const{id:e}=ms(),[t,n]=p.useState("Overview"),[o,s]=p.useState(!1);Ve("1",()=>{n("Overview"),Je("Switched to Overview",{icon:"",duration:1e3})}),Ve("2",()=>{n("Graph Analysis"),Je("Switched to Graph Analysis",{icon:"",duration:1e3})}),Ve("3",()=>{n("Timeline"),Je("Switched to Timeline",{icon:"",duration:1e3})}),Ve("4",()=>{n("Financials"),Je("Switched to Financials",{icon:"",duration:1e3})}),Ve("5",()=>{n("Evidence"),Je("Switched to Evidence",{icon:"",duration:1e3})}),Ve("shift+?",()=>s(i=>!i));const{data:r,isLoading:a}=Nt({queryKey:["case",e],queryFn:()=>vt.getCase(e),enabled:!!e});return Nt({queryKey:["case",e,"timeline"],queryFn:()=>vt.getCaseTimeline(e),enabled:!!e&&t==="Timeline"}),Nt({queryKey:["graph",r?.subject_name],queryFn:()=>vt.getGraph(r.subject_name),enabled:!!r?.subject_name&&t==="Graph Analysis"}),a?f.jsxs("div",{className:"p-8 space-y-6 min-h-screen bg-slate-50/50 dark:bg-slate-900/50",children:[f.jsx("div",{className:"h-8 bg-slate-200 dark:bg-slate-700 rounded w-1/3 animate-pulse"}),f.jsx("div",{className:"h-64 bg-slate-200 dark:bg-slate-700 rounded-2xl animate-pulse"})]}):r?f.jsx(Hs,{pageName:"Case Detail",children:f.jsxs("div",{className:"p-8 space-y-8 min-h-screen bg-slate-50/50 dark:bg-slate-900/50",children:[f.jsxs(gs,{to:"/cases",className:"inline-flex items-center text-sm text-slate-500 hover:text-slate-800 dark:text-slate-400 dark:hover:text-slate-200 transition-colors",children:[f.jsx(ps,{className:"h-4 w-4 mr-1"}),"Back to Cases"]}),f.jsx("div",{className:"bg-white/70 dark:bg-slate-800/70 backdrop-blur-xl rounded-2xl shadow-xl border border-white/20 dark:border-slate-700/50 p-6",children:f.jsxs("div",{className:"flex flex-col lg:flex-row justify-between gap-6",children:[f.jsxs("div",{className:"flex gap-6",children:[f.jsx("div",{className:"w-20 h-20 rounded-2xl bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center text-white text-2xl font-bold shadow-lg shadow-blue-500/20",children:r.subject_name.charAt(0)}),f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[f.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:r.subject_name}),f.jsx(Ts,{status:r.status})]}),f.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 font-mono mb-4",children:["ID: ",r.id]}),f.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:"Risk Score:"}),f.jsx("div",{className:"w-32",children:f.jsx(Ds,{score:r.risk_score})})]}),f.jsxs("div",{className:"flex items-center gap-2 text-slate-500 dark:text-slate-400",children:[f.jsx(In,{className:"h-4 w-4"}),f.jsxs("span",{children:["Updated ",new Date(r.created_at).toLocaleDateString()]})]})]})]})]}),f.jsxs("div",{className:"flex gap-3 items-start",children:[f.jsx("button",{className:"p-2 text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:f.jsx(xs,{className:"h-5 w-5"})}),f.jsx("button",{className:"p-2 text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:f.jsx(ys,{className:"h-5 w-5"})}),f.jsx("div",{className:"h-8 w-px bg-slate-200 dark:bg-slate-700 mx-1"}),f.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors font-medium shadow-sm",children:[f.jsx(bs,{className:"h-4 w-4 text-orange-500"}),"Escalate"]}),f.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-lg shadow-blue-500/20 font-medium",children:[f.jsx(ws,{className:"h-4 w-4"}),"Approve"]})]})]})}),f.jsx("div",{className:"border-b border-slate-200 dark:border-slate-700",children:f.jsx("nav",{className:"-mb-px flex space-x-8","aria-label":"Tabs",children:si.map(i=>f.jsxs("button",{onClick:()=>n(i.name),className:tn(t===i.name?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-slate-500 hover:border-slate-300 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-300","group inline-flex items-center border-b-2 py-4 px-1 text-sm font-medium transition-colors duration-200"),children:[f.jsx(i.icon,{className:tn(t===i.name?"text-blue-500 dark:text-blue-400":"text-slate-400 group-hover:text-slate-500 dark:text-slate-500","mr-2 h-5 w-5 transition-colors duration-200"),"aria-hidden":"true"}),i.name]},i.name))})}),f.jsx("div",{className:"min-h-[500px]",children:f.jsx(nn,{mode:"wait",children:f.jsxs(St.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},children:[t==="Overview"&&f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[f.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[f.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4",children:"Case Summary"}),f.jsx("p",{className:"text-slate-600 dark:text-slate-300 leading-relaxed",children:r.description||"No description available for this case."}),f.jsxs("div",{className:"mt-8 grid grid-cols-2 sm:grid-cols-4 gap-4",children:[f.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-slate-800/50 rounded-lg border border-slate-100 dark:border-slate-700/50",children:[f.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wider mb-1",children:"Total Alerts"}),f.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"12"})]}),f.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-slate-800/50 rounded-lg border border-slate-100 dark:border-slate-700/50",children:[f.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wider mb-1",children:"Evidence"}),f.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"5"})]}),f.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-slate-800/50 rounded-lg border border-slate-100 dark:border-slate-700/50",children:[f.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wider mb-1",children:"Linked Entities"}),f.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"8"})]}),f.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-slate-800/50 rounded-lg border border-slate-100 dark:border-slate-700/50",children:[f.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wider mb-1",children:"Days Open"}),f.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"3"})]})]})]}),f.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4",children:"Recent Activity"}),f.jsx($n,{})]})]}),f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-6",children:[f.jsx("h3",{className:"text-sm font-semibold text-slate-900 dark:text-white uppercase tracking-wider mb-4",children:"Case Details"}),f.jsxs("dl",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("dt",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Assigned To"}),f.jsxs("dd",{className:"text-sm font-medium text-slate-900 dark:text-white mt-1 flex items-center gap-2",children:[f.jsx("div",{className:"w-6 h-6 rounded-full bg-slate-200 dark:bg-slate-700 flex items-center justify-center text-xs",children:r.assigned_to.charAt(0)}),r.assigned_to]})]}),f.jsxs("div",{children:[f.jsx("dt",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Created Date"}),f.jsx("dd",{className:"text-sm font-medium text-slate-900 dark:text-white mt-1",children:new Date(r.created_at).toLocaleDateString()})]}),f.jsxs("div",{children:[f.jsx("dt",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Last Updated"}),f.jsx("dd",{className:"text-sm font-medium text-slate-900 dark:text-white mt-1",children:new Date(r.created_at).toLocaleDateString()})]}),f.jsxs("div",{children:[f.jsx("dt",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Priority"}),f.jsx("dd",{className:"mt-1",children:f.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-red-100 text-red-700 dark:bg-red-500/20 dark:text-red-300",children:"High"})})]})]})]}),f.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-xl border border-blue-100 dark:border-blue-800/30 p-6",children:[f.jsx("h3",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100 mb-2",children:"AI Insight"}),f.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300 leading-relaxed",children:"This case shows patterns consistent with structuring. The velocity of transactions has increased by 200% in the last 48 hours."})]})]})]}),t==="Graph Analysis"&&f.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-4 h-[600px]",children:f.jsx(ti,{})}),t==="Financials"&&f.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-4",children:f.jsx(oi,{})}),t==="Timeline"&&f.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-6",children:f.jsx($n,{})}),t==="Evidence"&&f.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-12 flex flex-col items-center justify-center text-center border-dashed",children:[f.jsx("div",{className:"w-16 h-16 bg-slate-100 dark:bg-slate-700/50 rounded-full flex items-center justify-center mb-4",children:f.jsx(_n,{className:"h-8 w-8 text-slate-400"})}),f.jsx("h3",{className:"text-lg font-medium text-slate-900 dark:text-white",children:"Evidence Files"}),f.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1 max-w-sm",children:"Upload and manage evidence files related to this case. Drag and drop files here or click to browse."}),f.jsx("button",{className:"mt-6 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-lg shadow-blue-500/20",children:"Upload Evidence"})]})]},t)})}),f.jsx(nn,{children:o&&f.jsx(St.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>s(!1),children:f.jsxs(St.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl border border-slate-200 dark:border-slate-700 p-8 max-w-md w-full",onClick:i=>i.stopPropagation(),children:[f.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-6",children:"Keyboard Shortcuts"}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Switch to Overview"}),f.jsx("kbd",{className:"px-3 py-1.5 bg-slate-100 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-lg text-sm font-medium",children:"1"})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Switch to Graph"}),f.jsx("kbd",{className:"px-3 py-1.5 bg-slate-100 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-lg text-sm font-medium",children:"2"})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Switch to Timeline"}),f.jsx("kbd",{className:"px-3 py-1.5 bg-slate-100 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-lg text-sm font-medium",children:"3"})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Switch to Financials"}),f.jsx("kbd",{className:"px-3 py-1.5 bg-slate-100 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-lg text-sm font-medium",children:"4"})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Switch to Evidence"}),f.jsx("kbd",{className:"px-3 py-1.5 bg-slate-100 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-lg text-sm font-medium",children:"5"})]}),f.jsx("div",{className:"h-px bg-slate-200 dark:bg-slate-700 my-4"}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Show/Hide Help"}),f.jsx("kbd",{className:"px-3 py-1.5 bg-slate-100 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-lg text-sm font-medium",children:"Shift + ?"})]})]}),f.jsx("button",{onClick:()=>s(!1),className:"mt-6 w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"Close"})]})})})]})}):f.jsx("div",{className:"p-8 min-h-screen bg-slate-50/50 dark:bg-slate-900/50",children:f.jsx("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg shadow-sm",children:"Case not found"})})}export{hi as CaseDetail};
