import{c as h,j as e,b as f,u as m}from"./query-vendor-CvBDT0OD.js";import{a as w}from"./react-vendor-BuVNz1jA.js";import{j as i}from"./index-BlWFTSEC.js";import{u as k,v as j,H as y,c as N,J as v,q as P,z as l}from"./ui-vendor-DqTYRHc5.js";import{P as S}from"./PageErrorBoundary-BlW1gdj2.js";import"./viz-vendor-Yg1nQkEx.js";function F(){const{data:r,isLoading:n}=h({queryKey:["audit-logs"],queryFn:()=>i.getAuditLogs()}),d=r?.items||[];return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"relative max-w-sm flex-1",children:[e.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:e.jsx(k,{className:"h-4 w-4 text-slate-400"})}),e.jsx("input",{type:"text",className:"block w-full rounded-md border-0 py-1.5 pl-10 text-slate-900 ring-1 ring-inset ring-slate-300 placeholder:text-slate-400 focus:ring-2 focus:ring-inset focus:ring-blue-600 sm:text-sm sm:leading-6 dark:bg-slate-800 dark:text-white dark:ring-slate-700",placeholder:"Search logs..."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{className:"inline-flex items-center justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-slate-900 shadow-sm ring-1 ring-inset ring-slate-300 hover:bg-slate-50 dark:bg-slate-800 dark:text-white dark:ring-slate-700 dark:hover:bg-slate-700",children:[e.jsx(j,{className:"mr-2 h-4 w-4"}),"Filter"]}),e.jsxs("button",{className:"inline-flex items-center justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-slate-900 shadow-sm ring-1 ring-inset ring-slate-300 hover:bg-slate-50 dark:bg-slate-800 dark:text-white dark:ring-slate-700 dark:hover:bg-slate-700",children:[e.jsx(y,{className:"mr-2 h-4 w-4"}),"Export"]})]})]}),e.jsx("div",{className:"rounded-lg border border-slate-200 bg-white shadow-sm dark:border-slate-700 dark:bg-slate-800",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200 dark:divide-slate-700",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-900",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-slate-500 dark:text-slate-400",children:"Timestamp"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-slate-500 dark:text-slate-400",children:"Actor"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-slate-500 dark:text-slate-400",children:"Action"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-slate-500 dark:text-slate-400",children:"Resource"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-slate-500 dark:text-slate-400",children:"Details"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 bg-white dark:divide-slate-700 dark:bg-slate-800",children:n?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-sm text-slate-500",children:"Loading logs..."})}):d.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-sm text-slate-500",children:"No audit logs found"})}):d.map(s=>e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-700/50",children:[e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-slate-500 dark:text-slate-400",children:s.timestamp}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm font-medium text-slate-900 dark:text-white",children:s.actor_id}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm",children:e.jsx("span",{className:"inline-flex items-center rounded-full bg-blue-100 px-2.5 py-0.5 text-xs font-medium text-blue-800 dark:bg-blue-900/30 dark:text-blue-400",children:s.action})}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-slate-500 dark:text-slate-400",children:s.resource_id}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-slate-500 dark:text-slate-400",children:JSON.stringify(s.details)})]},s.id))})]})})})]})}const E=[{id:"general",name:"General",icon:N},{id:"security",name:"Security",icon:v},{id:"audit",name:"Audit Log",icon:P}];function C(){const[r,n]=w.useState("general"),d=f(),{data:s,isLoading:g}=h({queryKey:["user","profile"],queryFn:i.getProfile}),o=m({mutationFn:i.updateProfile,onSuccess:()=>{d.invalidateQueries({queryKey:["user","profile"]}),l.success("Profile updated successfully")},onError:t=>{l.error(`Update failed: ${t instanceof Error?t.message:"Unknown error"}`)}}),x=m({mutationFn:i.updatePreferences,onSuccess:()=>{d.invalidateQueries({queryKey:["user","profile"]}),l.success("Preferences updated")}}),c=m({mutationFn:i.updatePassword,onSuccess:()=>{l.success("Password updated successfully");const t=document.getElementById("password-form");t&&t.reset()},onError:t=>{l.error(`Password update failed: ${t instanceof Error?t.message:"Unknown error"}`)}}),b=()=>{const a=document.documentElement.classList.contains("dark")?"light":"dark";x.mutate({theme:a}),document.documentElement.classList.toggle("dark")};return e.jsx(S,{pageName:"Settings",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Settings"}),e.jsx("div",{className:"border-b border-slate-200 dark:border-slate-700",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:E.map(t=>{const a=t.icon;return e.jsxs("button",{onClick:()=>n(t.id),className:`
                  flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm transition-colors
                  ${r===t.id?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300 dark:text-slate-400 dark:hover:text-slate-300"}
                `,children:[e.jsx(a,{className:"h-5 w-5"}),t.name]},t.id)})})}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow p-6",children:[r==="general"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:"General Settings"}),g?e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-10 bg-slate-200 rounded"}),e.jsx("div",{className:"h-10 bg-slate-200 rounded"})]}):e.jsxs("form",{onSubmit:t=>{t.preventDefault();const a=new FormData(t.currentTarget);o.mutate({name:a.get("name"),email:a.get("email")})},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"profile-name",className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Name"}),e.jsx("input",{id:"profile-name",type:"text",name:"name",defaultValue:s?.name,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-900 dark:border-slate-700 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"profile-email",className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Email"}),e.jsx("input",{id:"profile-email",type:"email",name:"email",defaultValue:s?.email,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-900 dark:border-slate-700 dark:text-white"})]}),e.jsx("button",{type:"submit",disabled:o.isPending,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:o.isPending?"Saving...":"Save Changes"})]}),e.jsx("div",{className:"pt-6 border-t border-slate-200 dark:border-slate-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-slate-900 dark:text-white",children:"Theme"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Toggle between light and dark mode"})]}),e.jsx("button",{onClick:b,disabled:x.isPending,className:"px-4 py-2 bg-slate-200 dark:bg-slate-700 text-slate-900 dark:text-white rounded-lg hover:bg-slate-300 dark:hover:bg-slate-600 transition-colors",children:document.documentElement.classList.contains("dark")?"Light Mode":"Dark Mode"})]})})]}),r==="security"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:"Security Settings"}),e.jsxs("form",{id:"password-form",onSubmit:t=>{t.preventDefault();const a=new FormData(t.currentTarget),u=a.get("current_password"),p=a.get("new_password");if(!u||!p){l.error("Please fill in all fields");return}c.mutate({current_password:u,new_password:p})},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"current-password",className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Current Password"}),e.jsx("input",{id:"current-password",type:"password",name:"current_password",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-900 dark:border-slate-700 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"new-password",className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"New Password"}),e.jsx("input",{id:"new-password",type:"password",name:"new_password",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-900 dark:border-slate-700 dark:text-white"})]}),e.jsx("button",{type:"submit",disabled:c.isPending,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:c.isPending?"Updating...":"Update Password"})]})]}),r==="audit"&&e.jsx(F,{})]})]})})}export{C as Settings};
